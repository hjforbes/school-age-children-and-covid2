----------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  E:\analyses\school-age-children-and-covid\analysis\log\an_multivariableFULL_cox_models_covid_deathSense2.log
  log type:  text
 opened on:  24 Jul 2020, 13:43:52

. 
. use "$tempdir\cr_create_analysis_dataset_STSET_`outcome'.dta", clear

. 
. 
. ******************************
. *  Multivariable Cox models  *
. ******************************
. 
. *************************************************************************************
. *PROG TO DEFINE THE BASIC COX MODEL WITH OPTIONS FOR HANDLING OF AGE, BMI, ETHNICITY:
. cap prog drop basecoxmodel

. prog define basecoxmodel
  1.         syntax , exposure(string) age(string) [ethnicity(real 0) if(string)] bmi(string) smoking(string)
  2. 
.         if `ethnicity'==1 local ethnicity "i.ethnicity"
  3.         else local ethnicity
  4. timer clear
  5. timer on 1
  6.         capture stcox   `exposure' `age'                ///
>                         i.male                                                  ///
>                         `bmi'                                                   ///
>                         `smoking'                                               ///
>                         `ethnicity'                                             ///
>                         i.imd                                                   ///
>                         i.htdiag_or_highbp                              ///
>                         i.chronic_respiratory_disease   ///
>                         i.asthma                                                ///
>                         i.chronic_cardiac_disease               ///
>                         i.diabetes                                              ///
>                         i.cancer_exhaem_cat                             ///
>                         i.cancer_haem_cat                               ///
>                         i.chronic_liver_disease                 ///
>                         i.stroke_dementia                               ///
>                         i.other_neuro                                   ///
>                         i.reduced_kidney_function_cat   ///
>                         i.organ_trans                                   ///
>                         i.tot_adults_hh                                 ///
>                         i.asplenia                                              ///
>                         i.ra_sle_psoriasis                      ///
>                         i.other_immuno                                  ///
>                         `if'                                                    ///
>                         , strata(stp) vce(cluster household_id)
  7. timer off 1
  8. timer list
  9. end

. *************************************************************************************
. 
. foreach exposure_type in        kids_cat3  ///
>                 gp_number_kids {
  2.  
. *Complete case ethnicity model
. basecoxmodel, exposure("i.`exposure_type'") age("age1 age2 age3") ethnicity(1) bmi(i.bmicat) smoking(i.smoke)
  3. if _rc==0{
  4. estimates
  5. estimates save ./output/an_multivariate_cox_models_`outcome'_`exposure_type'_MAINFULLYADJMODEL_CCeth_bmi_smoke, replace
  6. *estat concordance /*c-statistic*/
.  }
  7.  else di "WARNING CC ETHN BMI SMOK MODEL WITH AGESPLINE DID NOT FIT (OUTCOME `outcome')" 
  8.  
.  }
   1:     90.38 /        1 =      90.3780

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =    7,796,091             Number of obs    =     234,844
No. of failures      =          991
Time at risk         =   1059850057
                                                Wald chi2(43)    =     3182.41
Log pseudolikelihood =    -11128.74             Prob > chi2      =      0.0000

                                      (Std. Err. adjusted for 232,022 clusters in household_id)
-----------------------------------------------------------------------------------------------
                              |               Robust
                           _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------------+----------------------------------------------------------------
                    kids_cat3 |
               Kids under 12  |   .7094975   .0847819    -2.87   0.004     .5613529    .8967383
               Kids under 18  |   .7790766   .1098479    -1.77   0.077     .5909664    1.027064
                              |
                         age1 |    1.14152   .0781541     1.93   0.053     .9981733    1.305452
                         age2 |    .954069    .172269    -0.26   0.795     .6697069    1.359173
                         age3 |   .9377737   .4757033    -0.13   0.899     .3469845    2.534463
                       1.male |   2.198847   .1625888    10.66   0.000     1.902194    2.541764
                              |
                       bmicat |
          Normal (18.5-24.9)  |   .3537144   .0869813    -4.23   0.000     .2184415     .572757
        Overweight (25-29.9)  |   .3844659   .0931642    -3.94   0.000     .2391078    .6181898
           Obese I (30-34.9)  |   .4994272   .1226921    -2.83   0.005     .3085753    .8083198
          Obese II (35-39.9)  |   .8512407   .2158798    -0.64   0.525     .5178244    1.399337
             Obese III (40+)  |   .9944156   .2622055    -0.02   0.983     .5930957     1.66729
                              |
                        smoke |
                      Former  |    1.08163   .0817455     1.04   0.299     .9327136    1.254323
                     Current  |   .6520558   .0706034    -3.95   0.000     .5273734    .8062157
                              |
                    ethnicity |
                       Mixed  |     2.4423    .552676     3.95   0.000     1.567393    3.805574
      Asian or Asian British  |   2.392786   .2644973     7.89   0.000     1.926693    2.971633
                       Black  |   2.543791    .359633     6.60   0.000     1.928152    3.355997
                       Other  |   2.210404   .4248263     4.13   0.000     1.516617     3.22157
                              |
                          imd |
                           2  |   1.220808   .1615335     1.51   0.132     .9419304    1.582252
                           3  |   1.311913   .1684393     2.11   0.034     1.020041    1.687301
                           4  |   1.832195   .2224384     4.99   0.000     1.444213    2.324407
             5 most deprived  |   1.646516   .2156502     3.81   0.000     1.273741    2.128389
                              |
           1.htdiag_or_highbp |   1.170382   .0883687     2.08   0.037     1.009389    1.357054
1.chronic_respiratory_disease |    2.62036    .284418     8.88   0.000     2.118216    3.241542
                     1.asthma |   1.108861    .097387     1.18   0.239     .9335106    1.317149
    1.chronic_cardiac_disease |   1.608303   .1583453     4.83   0.000     1.326059     1.95062
                   1.diabetes |   2.037031   .1638489     8.85   0.000     1.739927    2.384867
                              |
            cancer_exhaem_cat |
                   Last year  |   4.123767   .9574044     6.10   0.000     2.616211     6.50003
               2-5 years ago  |   2.574337   .4792213     5.08   0.000     1.787357    3.707826
                    5+ years  |    1.76026   .3115741     3.19   0.001     1.244257    2.490252
                              |
              cancer_haem_cat |
                   Last year  |   7.530081   3.850721     3.95   0.000     2.763845    20.51567
               2-5 years ago  |   7.056608    2.38185     5.79   0.000     3.641547    13.67433
                    5+ years  |   2.231295   .7359811     2.43   0.015     1.168941    4.259135
                              |
      1.chronic_liver_disease |   3.170945   .5619187     6.51   0.000     2.240518    4.487753
            1.stroke_dementia |    1.93243   .2924359     4.35   0.000     1.436452    2.599661
                1.other_neuro |   4.761167   .8140838     9.13   0.000     3.405427    6.656644
                              |
  reduced_kidney_function_cat |
Stage 3a/3b egfr 30-60        |   2.169672    .278198     6.04   0.000     1.687532    2.789563
           Stage 4/5 egfr<30  |   8.173626   1.638644    10.48   0.000     5.517805    12.10774
                              |
                1.organ_trans |   2.208503   .6027722     2.90   0.004     1.293533    3.770671
                              |
                tot_adults_hh |
                           2  |   .7698637   .0690951    -2.91   0.004     .6456819    .9179289
                           3  |   .9878945   .0877079    -0.14   0.891     .8301157    1.175662
                              |
                   1.asplenia |   1.183621   .7292431     0.27   0.784     .3538156    3.959572
           1.ra_sle_psoriasis |   1.386762   .1659758     2.73   0.006     1.096794    1.753391
               1.other_immuno |   1.975216   .5603525     2.40   0.016     1.132755    3.444241
-----------------------------------------------------------------------------------------------
                                                             Stratified by stp
(note: file ./output/an_multivariate_cox_models_covid_death_kids_cat3_MAINFULLYADJMODEL_CCeth_bmi_smoke.ster not found)
file ./output/an_multivariate_cox_models_covid_death_kids_cat3_MAINFULLYADJMODEL_CCeth_bmi_smoke.ster saved
   1:     81.10 /        1 =      81.1030

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =    7,796,091             Number of obs    =     234,844
No. of failures      =          991
Time at risk         =   1059850057
                                                Wald chi2(45)    =     3190.40
Log pseudolikelihood =    -11126.42             Prob > chi2      =      0.0000

                                      (Std. Err. adjusted for 232,022 clusters in household_id)
-----------------------------------------------------------------------------------------------
                              |               Robust
                           _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------------+----------------------------------------------------------------
               gp_number_kids |
              only >12 years  |   .7780994   .1097489    -1.78   0.075     .5901676    1.025876
                 1 child <12  |   .8287314   .1108819    -1.40   0.160     .6375664    1.077214
              2 children <12  |   .5459848   .1181732    -2.80   0.005     .3572285    .8344783
             3+ children <12  |    .512129   .1923351    -1.78   0.075     .2453026    1.069194
                              |
                         age1 |   1.145906   .0781081     2.00   0.046     1.002602    1.309692
                         age2 |   .9407898   .1694833    -0.34   0.735     .6609196    1.339173
                         age3 |   .9835815   .4986213    -0.03   0.974     .3641651    2.656577
                       1.male |   2.196891   .1623983    10.65   0.000      1.90058    2.539399
                              |
                       bmicat |
          Normal (18.5-24.9)  |   .3528144   .0867424    -4.24   0.000      .217907    .5712436
        Overweight (25-29.9)  |   .3830687   .0928121    -3.96   0.000     .2382554    .6159005
           Obese I (30-34.9)  |   .4984581   .1224927    -2.83   0.005     .3079297     .806874
          Obese II (35-39.9)  |   .8505964   .2155947    -0.64   0.523     .5175776    1.397885
             Obese III (40+)  |   .9897758   .2609956    -0.04   0.969     .5903127    1.659555
                              |
                        smoke |
                      Former  |   1.079499   .0815988     1.01   0.312     .9308512    1.251884
                     Current  |   .6495348   .0703527    -3.98   0.000     .5252992    .8031526
                              |
                    ethnicity |
                       Mixed  |   2.458152   .5558938     3.98   0.000     1.578031    3.829146
      Asian or Asian British  |   2.405368   .2659009     7.94   0.000     1.936804     2.98729
                       Black  |   2.546812   .3605118     6.60   0.000     1.929771    3.361151
                       Other  |   2.213386   .4254602     4.13   0.000     1.518581    3.226089
                              |
                          imd |
                           2  |   1.220728   .1615666     1.51   0.132     .9418026    1.582259
                           3  |    1.31255   .1685045     2.12   0.034     1.020561    1.688079
                           4  |   1.829109   .2221209     4.97   0.000     1.441692    2.320634
             5 most deprived  |   1.651545   .2160537     3.84   0.000     1.278018    2.134243
                              |
           1.htdiag_or_highbp |   1.170362   .0883412     2.08   0.037     1.009415    1.356971
1.chronic_respiratory_disease |   2.627374   .2847732     8.91   0.000      2.12453    3.249235
                     1.asthma |   1.111118   .0974725     1.20   0.230     .9355968    1.319568
    1.chronic_cardiac_disease |   1.612802   .1585851     4.86   0.000     1.330097    1.955595
                   1.diabetes |    2.03311   .1637157     8.81   0.000     1.736273    2.380694
                              |
            cancer_exhaem_cat |
                   Last year  |   4.132417   .9597531     6.11   0.000     2.621276    6.514717
               2-5 years ago  |   2.558188   .4764301     5.04   0.000     1.775853    3.685174
                    5+ years  |   1.753779   .3108646     3.17   0.002      1.23907    2.482297
                              |
              cancer_haem_cat |
                   Last year  |   7.462434   3.822866     3.92   0.000     2.734172    20.36738
               2-5 years ago  |   7.051662   2.380247     5.79   0.000     3.638927      13.665
                    5+ years  |   2.236888   .7389374     2.44   0.015      1.17073    4.273971
                              |
      1.chronic_liver_disease |   3.170822   .5627234     6.50   0.000     2.239287    4.489872
            1.stroke_dementia |   1.924051   .2916464     4.32   0.000     1.429526    2.589651
                1.other_neuro |   4.746082   .8116291     9.11   0.000     3.394462    6.635895
                              |
  reduced_kidney_function_cat |
Stage 3a/3b egfr 30-60        |     2.1755   .2789041     6.06   0.000     1.692127    2.796952
           Stage 4/5 egfr<30  |   8.292868   1.665524    10.53   0.000     5.594368    12.29302
                              |
                1.organ_trans |     2.1979   .6004526     2.88   0.004     1.286663     3.75449
                              |
                tot_adults_hh |
                           2  |   .7709883   .0691803    -2.90   0.004      .646651    .9192329
                           3  |   .9900377   .0878255    -0.11   0.910     .8320363    1.178043
                              |
                   1.asplenia |   1.182189   .7286212     0.27   0.786     .3532351    3.956488
           1.ra_sle_psoriasis |   1.381049   .1653229     2.70   0.007     1.092228    1.746244
               1.other_immuno |   1.950087   .5541904     2.35   0.019     1.117258    3.403728
-----------------------------------------------------------------------------------------------
                                                             Stratified by stp
(note: file ./output/an_multivariate_cox_models_covid_death_gp_number_kids_MAINFULLYADJMODEL_CCeth_bmi_smoke.ster not found)
file ./output/an_multivariate_cox_models_covid_death_gp_number_kids_MAINFULLYADJMODEL_CCeth_bmi_smoke.ster saved

. 
. 
. log close
      name:  <unnamed>
       log:  E:\analyses\school-age-children-and-covid\analysis\log\an_multivariableFULL_cox_models_covid_deathSense2.log
  log type:  text
 closed on:  24 Jul 2020, 13:46:50
----------------------------------------------------------------------------------------------------------------------------------
