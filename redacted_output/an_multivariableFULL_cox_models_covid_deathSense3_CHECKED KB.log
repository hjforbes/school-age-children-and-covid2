----------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  E:\analyses\school-age-children-and-covid\analysis\log\an_multivariableFULL_cox_models_covid_deathSense3.log
  log type:  text
 opened on:  24 Jul 2020, 13:43:53

. 
. use "$tempdir\cr_create_analysis_dataset_STSET_`outcome'.dta", clear

. 
. 
. ******************************
. *  Multivariable Cox models  *
. ******************************
. 
. *************************************************************************************
. *PROG TO DEFINE THE BASIC COX MODEL WITH OPTIONS FOR HANDLING OF AGE, BMI, ETHNICITY:
. cap prog drop basecoxmodel

. prog define basecoxmodel
  1.         syntax , exposure(string) age(string) [ethnicity(real 0) if(string)] bmi(string) smoking(string)
  2. 
.         if `ethnicity'==1 local ethnicity "i.ethnicity"
  3.         else local ethnicity
  4. timer clear
  5. timer on 1
  6.         capture stcox   `exposure' `age'                ///
>                         i.male                                                  ///
>                         `bmi'                                                   ///
>                         `smoking'                                               ///
>                         `ethnicity'                                             ///
>                         i.imd                                                   ///
>                         i.htdiag_or_highbp                              ///
>                         i.chronic_respiratory_disease   ///
>                         i.asthma                                                ///
>                         i.chronic_cardiac_disease               ///
>                         i.diabetes                                              ///
>                         i.cancer_exhaem_cat                             ///
>                         i.cancer_haem_cat                               ///
>                         i.chronic_liver_disease                 ///
>                         i.stroke_dementia                               ///
>                         i.other_neuro                                   ///
>                         i.reduced_kidney_function_cat   ///
>                         i.organ_trans                                   ///
>                         i.tot_adults_hh                                 ///
>                         i.asplenia                                              ///
>                         i.ra_sle_psoriasis                      ///
>                         i.other_immuno                                  ///
>                         `if'                                                    ///
>                         , strata(stp) vce(cluster household_id)
  7. timer off 1
  8. timer list
  9. end

. *************************************************************************************
. 
. foreach exposure_type in        kids_cat3  ///
>                 gp_number_kids {
  2.  
. *Complete case ethnicity model
. basecoxmodel, exposure("i.`exposure_type'") age("age1 age2 age3") ethnicity(0) bmi(i.bmicat) smoking(i.smoke)
  3. if _rc==0{
  4. estimates
  5. estimates save ./output/an_multivariate_cox_models_`outcome'_`exposure_type'_MAINFULLYADJMODEL_CCnoeth_bmi_smoke, replace
  6. *estat concordance /*c-statistic*/
.  }
  7.  else di "WARNING CC BMI SMOK MODEL WITH AGESPLINE DID NOT FIT (OUTCOME `outcome')" 
  8.  }
   1:    104.78 /        1 =     104.7820

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =    9,392,901             Number of obs    =     282,952
No. of failures      =        1,201
Time at risk         =   1276905917
                                                Wald chi2(39)    =     3665.97
Log pseudolikelihood =    -13733.42             Prob > chi2      =      0.0000

                                      (Std. Err. adjusted for 279,074 clusters in household_id)
-----------------------------------------------------------------------------------------------
                              |               Robust
                           _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------------+----------------------------------------------------------------
                    kids_cat3 |
               Kids under 12  |   .8473727    .093029    -1.51   0.131     .6833216    1.050809
               Kids under 18  |   .9973656   .1214504    -0.02   0.983     .7856019    1.266211
                              |
                         age1 |   1.147602    .067845     2.33   0.020     1.022043    1.288586
                         age2 |   .9380138   .1475606    -0.41   0.684     .6891365    1.276772
                         age3 |   .9598062   .4274167    -0.09   0.927      .400987    2.297401
                       1.male |   2.166091   .1445417    11.58   0.000     1.900538    2.468748
                              |
                       bmicat |
          Normal (18.5-24.9)  |   .3746765   .0829418    -4.43   0.000     .2427877    .5782108
        Overweight (25-29.9)  |   .3706357   .0812494    -4.53   0.000     .2411848    .5695666
           Obese I (30-34.9)  |   .5005566     .11112    -3.12   0.002     .3239608    .7734174
          Obese II (35-39.9)  |    .783037   .1796505    -1.07   0.286      .499451    1.227642
             Obese III (40+)  |   .8686988   .2063479    -0.59   0.553     .5453529     1.38376
                              |
                        smoke |
                      Former  |    1.00785   .0688863     0.11   0.909     .8814886    1.152326
                     Current  |   .6251139   .0604674    -4.86   0.000     .5171567    .7556072
                              |
                          imd |
                           2  |   1.229658   .1407526     1.81   0.071     .9825432    1.538923
                           3  |   1.280439   .1455142     2.18   0.030     1.024767    1.599901
                           4  |   1.897393   .2029826     5.99   0.000     1.538494    2.340015
             5 most deprived  |   1.914346   .2181423     5.70   0.000     1.531175    2.393404
                              |
           1.htdiag_or_highbp |    1.17717   .0815096     2.36   0.018      1.02778    1.348274
1.chronic_respiratory_disease |   2.434451   .2393478     9.05   0.000     2.007768    2.951812
                     1.asthma |   1.122611   .0890947     1.46   0.145     .9608924    1.311547
    1.chronic_cardiac_disease |    1.69699   .1494928     6.00   0.000     1.427889    2.016806
                   1.diabetes |   2.233679   .1604106    11.19   0.000     1.940404     2.57128
                              |
            cancer_exhaem_cat |
                   Last year  |   3.781552   .8103101     6.21   0.000     2.484705    5.755266
               2-5 years ago  |    2.52049   .4196723     5.55   0.000      1.81868    3.493121
                    5+ years  |   1.661479   .2664062     3.17   0.002     1.213419    2.274986
                              |
              cancer_haem_cat |
                   Last year  |    6.11257    2.94781     3.75   0.000     2.375356    15.72965
               2-5 years ago  |   7.391121   2.095997     7.05   0.000     4.239591    12.88536
                    5+ years  |   2.296694   .6898874     2.77   0.006     1.274726     4.13799
                              |
      1.chronic_liver_disease |   3.577056   .5861154     7.78   0.000     2.594495    4.931722
            1.stroke_dementia |   1.662315    .244672     3.45   0.001     1.245739    2.218194
                1.other_neuro |   4.796875    .732164    10.27   0.000     3.556612    6.469642
                              |
  reduced_kidney_function_cat |
Stage 3a/3b egfr 30-60        |   2.160435   .2515281     6.62   0.000     1.719651    2.714201
           Stage 4/5 egfr<30  |   9.260464    1.70897    12.06   0.000     6.449825    13.29589
                              |
                1.organ_trans |   2.036775   .5054456     2.87   0.004     1.252302    3.312662
                              |
                tot_adults_hh |
                           2  |   .7908321     .06516    -2.85   0.004     .6728994    .9294337
                           3  |   1.120368   .0899653     1.42   0.157     .9572144    1.311329
                              |
                   1.asplenia |   1.246639   .6535448     0.42   0.674     .4461718    3.483206
           1.ra_sle_psoriasis |   1.323548    .143123     2.59   0.010     1.070765    1.636007
               1.other_immuno |   2.587882    .646163     3.81   0.000     1.586389    4.221621
-----------------------------------------------------------------------------------------------
                                                             Stratified by stp
(note: file ./output/an_multivariate_cox_models_covid_death_kids_cat3_MAINFULLYADJMODEL_CCnoeth_bmi_smoke.ster not found)
file ./output/an_multivariate_cox_models_covid_death_kids_cat3_MAINFULLYADJMODEL_CCnoeth_bmi_smoke.ster saved
   1:     95.68 /        1 =      95.6800

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =    9,392,901             Number of obs    =     282,952
No. of failures      =        1,201
Time at risk         =   1276905917
                                                Wald chi2(41)    =     3676.81
Log pseudolikelihood =   -13732.737             Prob > chi2      =      0.0000

                                      (Std. Err. adjusted for 279,074 clusters in household_id)
-----------------------------------------------------------------------------------------------
                              |               Robust
                           _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------------+----------------------------------------------------------------
               gp_number_kids |
              only >12 years  |   .9970652   .1214341    -0.02   0.981      .785334     1.26588
                 1 child <12  |   .9166764   .1154156    -0.69   0.490     .7162163    1.173243
              2 children <12  |   .7574918   .1440566    -1.46   0.144     .5217951    1.099654
             3+ children <12  |   .6994831   .2299988    -1.09   0.277     .3671905    1.332487
                              |
                         age1 |   1.149629   .0678605     2.36   0.018      1.02403    1.290633
                         age2 |   .9318471   .1466247    -0.45   0.654     .6845567    1.268469
                         age3 |   .9816668   .4378052    -0.04   0.967     .4095849    2.352796
                       1.male |   2.166078   .1446127    11.58   0.000     1.900403    2.468894
                              |
                       bmicat |
          Normal (18.5-24.9)  |   .3739675   .0827565    -4.44   0.000     .2423643    .5770308
        Overweight (25-29.9)  |   .3696666    .081006    -4.54   0.000     .2405937    .5679842
           Obese I (30-34.9)  |   .4994532   .1108773    -3.13   0.002     .3232438    .7717192
          Obese II (35-39.9)  |   .7817456   .1792638    -1.07   0.283     .4987404    1.225339
             Obese III (40+)  |   .8659302    .205642    -0.61   0.544     .5436741    1.379199
                              |
                        smoke |
                      Former  |   1.006927   .0688324     0.10   0.920     .8806648    1.151291
                     Current  |   .6236053   .0603758    -4.88   0.000     .5158206    .7539123
                              |
                          imd |
                           2  |   1.229787   .1407852     1.81   0.071     .9826189    1.539129
                           3  |   1.281187   .1456089     2.18   0.029      1.02535    1.600858
                           4  |    1.89645   .2029126     5.98   0.000     1.537681    2.338927
             5 most deprived  |   1.917358   .2184528     5.71   0.000     1.533635     2.39709
                              |
           1.htdiag_or_highbp |   1.176908    .081479     2.35   0.019     1.027573    1.347946
1.chronic_respiratory_disease |   2.437194   .2396232     9.06   0.000     2.010021    2.955151
                     1.asthma |   1.122836   .0890893     1.46   0.144     .9611241    1.311757
    1.chronic_cardiac_disease |   1.699732   .1497171     6.02   0.000     1.430225    2.020025
                   1.diabetes |   2.233154   .1604394    11.18   0.000     1.939835    2.570826
                              |
            cancer_exhaem_cat |
                   Last year  |   3.782131   .8106901     6.21   0.000     2.484756     5.75691
               2-5 years ago  |   2.514989   .4188061     5.54   0.000      1.81464    3.485632
                    5+ years  |    1.65848   .2660908     3.15   0.002     1.210992    2.271324
                              |
              cancer_haem_cat |
                   Last year  |   6.097714   2.941348     3.75   0.000     2.369048    15.69496
               2-5 years ago  |    7.38586   2.095257     7.05   0.000     4.235727    12.87876
                    5+ years  |   2.298824   .6909012     2.77   0.006     1.275501    4.143148
                              |
      1.chronic_liver_disease |   3.576854   .5865914     7.77   0.000     2.593625     4.93282
            1.stroke_dementia |   1.657358   .2443161     3.43   0.001     1.241476    2.212557
                1.other_neuro |   4.794204   .7317345    10.27   0.000     3.554663    6.465983
                              |
  reduced_kidney_function_cat |
Stage 3a/3b egfr 30-60        |   2.164335   .2521119     6.63   0.000     1.722552    2.719421
           Stage 4/5 egfr<30  |   9.322491   1.724468    12.07   0.000     6.487499    13.39635
                              |
                1.organ_trans |   2.033305   .5053699     2.86   0.004     1.249222    3.309522
                              |
                tot_adults_hh |
                           2  |   .7913839   .0652077    -2.84   0.005     .6733653    .9300872
                           3  |   1.121782   .0900541     1.43   0.152     .9584648    1.312929
                              |
                   1.asplenia |   1.241311   .6510819     0.41   0.680     .4440336    3.470129
           1.ra_sle_psoriasis |   1.321965   .1429372     2.58   0.010     1.069508    1.634015
               1.other_immuno |   2.576387   .6438814     3.79   0.000     1.578635    4.204751
-----------------------------------------------------------------------------------------------
                                                             Stratified by stp
(note: file ./output/an_multivariate_cox_models_covid_death_gp_number_kids_MAINFULLYADJMODEL_CCnoeth_bmi_smoke.ster not found)
file ./output/an_multivariate_cox_models_covid_death_gp_number_kids_MAINFULLYADJMODEL_CCnoeth_bmi_smoke.ster saved

. 
. 
. 
. 
. 
. 
. log close
      name:  <unnamed>
       log:  E:\analyses\school-age-children-and-covid\analysis\log\an_multivariableFULL_cox_models_covid_deathSense3.log
  log type:  text
 closed on:  24 Jul 2020, 13:47:20
----------------------------------------------------------------------------------------------------------------------------------
