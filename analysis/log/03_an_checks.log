------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:\Users\ENCDHFOR\Documents\GitHub\school-age-children-and-covid\analysis\log\03_an_checks.log
  log type:  text
 opened on:  26 Jun 2020, 11:02:23

. 
. * Open Stata dataset
. use $tempdir\analysis_dataset, clear
file tempdata\analysis_dataset.dta not found
r(601);

end of do-file

r(601);

. tab cancer

     cancer |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      6,311       79.94       79.94
          1 |      1,584       20.06      100.00
------------+-----------------------------------
      Total |      7,895      100.00

. br cancer*

. sum temp*

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
temp_immun~f |      1,557    21795.77    103.0662      21623      21960
   temp_immu |      7,895    .1972134      .39792          0          1

. br temp_immunodef temp_immu

. do "C:\Users\ENCDHFOR\AppData\Local\Temp\STD23f4_000000.tmp"

. * Immunosuppressed:
. * Permanent immunodeficiency ever, OR 
. * Temporary immunodeficiency  last year
. gen temp1  = perm_immunodef
(6,305 missing values generated)

. gen temp2  = inrange(temp_immunodef, (date("$indexdate", "DMY") - 365), date("$indexdate", "DMY"))

. 
. egen immunodef_any = rowmax(temp1 temp2)

. drop temp1 temp2 

. order immunodef_any, after(temp_immunodef_date)
variable temp_immunodef_date not found
(error in option after())
r(111);

end of do-file

r(111);

. do "C:\Users\ENCDHFOR\AppData\Local\Temp\STD23f4_000000.tmp"

. order immunodef_any, after(temp_immunodef)

. 
end of do-file

. br *immuno*

. do "C:\Users\ENCDHFOR\AppData\Local\Temp\STD23f4_000000.tmp"

. import delimited input.csv, clear
(37 vars, 10,000 obs)

. set more off 

. 
. ***********************HOUSE-KEEPING*******************************************
. * Create directories required 
. capture mkdir output

. capture mkdir log

. capture mkdir tempdata

. 
. * Set globals that will print in programs and direct output
. global pri_outcome        "tpp_infec"

. global sec_outcome        "comb_death_ITU"

. 
. global outdir     "output" 

. global logdir     "log"

. global tempdir    "tempdata"

. global varlist          i.obese4cat                                     ///
>                                         i.smoke_nomiss                          ///
>                                         i.imd                                           ///
>                                         i.ckd                                           ///
>                                         i.hypertension                          ///
>                                         i.heart_failure                         ///
>                                         i.other_heart_disease           ///
>                                         i.diabcat                                       ///
>                                         i.cancer_ever                           ///
>                                         i.statin                                        ///
>                                         i.flu_vaccine                           ///
>                                         i.pneumococcal_vaccine          ///
>                                         i.exacerbations                         ///
>                                         i.asthma_ever                           ///
>                                         i.immunodef_any

.                                         
. global table_pri_outcome "COVID-19 infection"

. global table_sec_outcome "COVID-19 Death or ITU admission"

. 
. global ymax 0.005

. 
end of do-file

. do "C:\Users\ENCDHFOR\Documents\GitHub\school-age-children-and-covid\analysis\01_cr_analysis_dataset.do"

. /*==============================================================================
> DO FILE NAME:                   00_cr_analysis_dataset
> PROJECT:                                Exposure children and COVID risk
> DATE:                                   25th June 2020 
> AUTHOR:                                 Harriet Forbes adapted from A Wong, A Schultze, C Rentsch,
>                                                  K Baskharan, E Williamson                                      
>                                         
> DESCRIPTION OF FILE:    program 00, data management for project  
>                                                 reformat variables 
>                                                 categorise variables
>                                                 label variables 
> DATASETS USED:                  data in memory (from analysis/input.csv)
> DATASETS CREATED:               none
> OTHER OUTPUT:                   logfiles, printed to folder analysis/$logdir
>                                                         
> ==============================================================================*/
. 
. * Open a log file
. 
. cap log close
