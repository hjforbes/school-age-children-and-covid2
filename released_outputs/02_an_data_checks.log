----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  E:\alex\school-age-children-and-covid\analysis\log\02_an_data_checks.log
  log type:  text
 opened on:   9 Jul 2020, 12:42:22

. 
. * Open Stata dataset
. use $tempdir\analysis_dataset, clear

. 
. *run ssc install if not on local machine - server needs datacheck.ado file
. *ssc install datacheck 
. 
. *Duplicate patient check
. datacheck _n==1, by(patient_id) nol

. 
. 
. /* CHECK INCLUSION AND EXCLUSION CRITERIA=====================================*/ 
. 
. * DATA STRUCTURE: Confirm one row per patient 
. duplicates tag patient_id, generate(dup_check)

Duplicates in terms of patient_id

. assert dup_check == 0 

. drop dup_check

. 
. * INCLUSION 1: >=18 and <=110 at 1 March 2020 
. assert age < .

. assert age >= 18 

. assert age <= 110

.  
. * INCLUSION 2: M or F gender at 1 March 2020 
. assert inlist(sex, "M", "F")

. 
. * EXCLUDE 1:  MISSING IMD
. assert inlist(imd, 1, 2, 3, 4, 5)

. 
. * EXCLUDE 2:  HH with more than 10 people
. datacheck inlist(household_size, 1, 2, 3, 4, 5,6, 7, 8, 9, 10), nol

 (267091 contradictions)

. 
. /* EXPECTED VALUES============================================================*/ 
. 
. *HH
. datacheck kids_cat3<., nol

. datacheck inlist(kids_cat3, 0,1, 2), nol

. 
. datacheck number_kids<., nol

. datacheck inlist(number_kids, 0,1,2,3,4,5,6,7,8,9), nol

. 
. * Age
. datacheck age<., nol

. datacheck inlist(agegroup, 1, 2, 3, 4, 5, 6), nol

 (1057935 contradictions)

. datacheck inlist(age66, 0, 1), nol

. 
. * Sex
. datacheck inlist(male, 0, 1), nol

. 
. * BMI 
. datacheck inlist(obese4cat, 1, 2, 3, 4), nol

. datacheck inlist(bmicat, 1, 2, 3, 4, 5, 6, .u), nol

. 
. * IMD
. datacheck inlist(imd, 1, 2, 3, 4, 5), nol

. 
. * Ethnicity
. datacheck inlist(ethnicity, 1, 2, 3, 4, 5, .u), nol

. 
. * Smoking
. datacheck inlist(smoke, 1, 2, 3, .u), nol

. datacheck inlist(smoke_nomiss, 1, 2, 3), nol 

. 
. 
. * Check date ranges for all comorbidities 
. 
. foreach var of varlist  chronic_respiratory_disease     ///
>                                         chronic_cardiac_disease         ///
>                                         diabetes                                                ///
>                                         chronic_liver_disease           ///
>                                         other_neuro                     ///
>                                         stroke_dementia ///
>                                         ra_sle_psoriasis                                ///
>                                         perm_immunodef  ///
>                                         temp_immunodef  ///
>                                         organ_trans                     /// 
>                                         asplenia                        /// 
>                                         hypertension                            ///
>                                         {
  2.                                                 
.         summ `var'_date, format
  3. 
. }

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
chronic_r~te |    665,080   23mar2009    6398.382  15dec1899  15jul2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
chronic_c~te |  1,105,553   07nov2006    6610.768  15jan1840  15sep2106

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
diabetes_d~e |  1,639,133   24dec2008    6542.487  15jan1860  15jul2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
chronic_l~te |     98,771   07sep2009    6348.679  15dec1840  15jul2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
other_neur~e |    163,522   31dec2001    8137.735  15jan1860  15jul2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
stroke_dem~e |    387,193   31jul2010    5500.912  15dec1899  15jul2096

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
ra_sle_pso~e |    815,769   09may2002     7365.88  15jan1840  15mar3000

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
perm_immun~e |    273,353   17jun2013    2894.768  15jan1900  15jan2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
temp_immun~e |      4,211   11sep2019    93.37349  15mar2019  15jan2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
organ_tran~e |     18,604   20jun2007    5571.147  15dec1899  15jun2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
asplenia_d~e |     23,127   20nov1992    9064.021  15dec1899  15jun2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
hypertensi~e |  3,395,634   04aug2004    7264.051  15jan1800  15feb2058

. 
. foreach comorb in $varlist { 
  2. 
.         local comorb: subinstr local comorb "i." ""
  3.         safetab `comorb', m
  4.         
. }

. 
. * Outcome dates
. summ  date_covid_death_itu  date_covid_tpp_prob_or_susp, format

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
date_covid~u |     64,143   31mar2020    33.04251  02feb2020  01jun2020
date_covid~p |    655,529   22apr2020    30.35292  15feb2020  15jul2020

. summ  date_covid_death_itu  date_covid_tpp_prob, format

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
date_covid~u |     64,143   31mar2020    33.04251  02feb2020  01jun2020
date_covid~b |     45,662   30apr2020    27.43641  15feb2020  15jul2020

. 
. /* LOGICAL RELATIONSHIPS======================================================*/ 
. 
. *HH variables
. safetab kids_cat3 additional
0

  Presence of |
  children or |
 young people |
       in the |        Number of additional people in household
    household |         0          1          2          3          4 |     Total
--------------+-------------------------------------------------------+----------
      No kids | 4,127,371  6,738,113  2,821,002  1,438,046  1,214,797 |16,339,329 
--------------+-------------------------------------------------------+----------
        Total | 4,127,371  6,738,113  2,821,002  1,438,046  1,214,797 |16,339,329 

. safetab number_kids add
0

 Number of |
  children |
aged 1-<12 |
  years in |        Number of additional people in household
 household |         0          1          2          3          4 |     Total
-----------+-------------------------------------------------------+----------
         0 | 4,127,371  6,738,113  2,821,002  1,438,046  1,214,797 |16,339,329 
-----------+-------------------------------------------------------+----------
     Total | 4,127,371  6,738,113  2,821,002  1,438,046  1,214,797 |16,339,329 

. safetab add kids_cat3
0

           |  Presence
           |     of
           |  children
           |  or young
 Number of | people in
additional |    the
 people in | household
 household |   No kids |     Total
-----------+-----------+----------
         0 | 4,127,371 | 4,127,371 
         1 | 6,738,113 | 6,738,113 
         2 | 2,821,002 | 2,821,002 
         3 | 1,438,046 | 1,438,046 
         4 | 1,214,797 | 1,214,797 
-----------+-----------+----------
     Total |16,339,329 |16,339,329 

. 
. * BMI
. bysort bmicat: summ bmi

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> bmicat = Underweight (<18.5)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         bmi |    310,994    17.42303    .8304391         15       18.4

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> bmicat = Normal (18.5-24.9)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         bmi |  4,664,052    22.34566     1.71655       18.5       24.9

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> bmicat = Overweight (25-29.9)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         bmi |  4,420,940    27.26787    1.413672         25       29.9

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> bmicat = Obese I (30-34.9)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         bmi |  2,230,374    32.08322    1.416634         30       34.9

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> bmicat = Obese II (35-39.9)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         bmi |    863,689    37.05073    1.406933         35       39.9

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> bmicat = Obese III (40+)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         bmi |    435,411    43.39243    2.640464         40         50

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> bmicat = Unknown (.u)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         bmi |          0


. safetab bmicat obese4cat, m
17

                     |     Evidence of obesity (4 categories)
         Grouped BMI | No record  Obese I (  Obese II   Obese III |     Total
---------------------+--------------------------------------------+----------
 Underweight (<18.5) |   310,994          0          0          0 |   310,994 
  Normal (18.5-24.9) | 4,664,052          0          0          0 | 4,664,052 
Overweight (25-29.9) | 4,420,940          0          0          0 | 4,420,940 
   Obese I (30-34.9) |         0  2,230,374          0          0 | 2,230,374 
  Obese II (35-39.9) |         0          0    863,689          0 |   863,689 
     Obese III (40+) |         0          0          0    435,411 |   435,411 
        Unknown (.u) | 3,413,869          0          0          0 | 3,413,869 
---------------------+--------------------------------------------+----------
               Total |12,809,855  2,230,374    863,689    435,411 |16,339,329 

. 
. * Age
. bysort agegroup: summ age

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> agegroup = 18-<30

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |  3,112,293    23.86788    3.424595         18         29

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> agegroup = 30-<40

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |  2,947,939    34.42933    2.869522         30         39

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> agegroup = 40-<50

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |  2,596,549     44.5338    2.926544         40         49

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> agegroup = 50-<60

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |  2,696,195    54.43721    2.846854         50         59

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> agegroup = 60-<70

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |  2,162,853    64.31417    2.883639         60         69

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> agegroup = 70-<80

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |  1,765,565    73.95762     2.75977         70         79

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> agegroup = 80+

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |  1,057,935    85.40192    4.477702         80        110


. safetab agegroup age66, m
15

   Grouped |  66 years and older
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<30 | 3,112,293          0 | 3,112,293 
    30-<40 | 2,947,939          0 | 2,947,939 
    40-<50 | 2,596,549          0 | 2,596,549 
    50-<60 | 2,696,195          0 | 2,696,195 
    60-<70 | 1,559,959    602,894 | 2,162,853 
    70-<80 |         0  1,765,565 | 1,765,565 
       80+ |         0  1,057,935 | 1,057,935 
-----------+----------------------+----------
     Total |12,912,935  3,426,394 |16,339,329 

. 
. * Smoking
. safetab smoke smoke_nomiss, m
19

             |  Smoking status (missing set to
     Smoking |               non)
      status |     Never     Former    Current |     Total
-------------+---------------------------------+----------
       Never | 7,475,051          0          0 | 7,475,051 
      Former |         0  5,275,820          0 | 5,275,820 
     Current |         0          0  2,854,233 | 2,854,233 
Unknown (.u) |   734,225          0          0 |   734,225 
-------------+---------------------------------+----------
       Total | 8,209,276  5,275,820  2,854,233 |16,339,329 

. 
. * Diabetes
. *safetab diabcat diabetes, m
. 
. * CKD
. safetab reduced egfr_cat, m
17

       Reduced kidney |                          Calculated eGFR
             function |         0         15         30         45         60          . |     Total
----------------------+------------------------------------------------------------------+----------
                 None |         0          0          0          0 10,987,780  4,349,647 |15,337,427 
Stage 3a/3b egfr 30-6 |         0          0    238,547    690,017          0          0 |   928,564 
    Stage 4/5 egfr<30 |    13,914     59,424          0          0          0          0 |    73,338 
----------------------+------------------------------------------------------------------+----------
                Total |    13,914     59,424    238,547    690,017 10,987,780  4,349,647 |16,339,329 

. 
. 
. /* EXPECTED RELATIONSHIPS=====================================================*/ 
. 
. /*  Relationships between demographic/lifestyle variables  */
. safetab agegroup bmicat,        row 
16

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

   Grouped |                            Grouped BMI
       age | Underweig  Normal (1  Overweigh  Obese I (  Obese II   Obese III |     Total
-----------+------------------------------------------------------------------+----------
    18-<30 |   119,428  1,011,258    452,375    200,032     90,126     53,046 | 1,926,265 
           |      6.20      52.50      23.48      10.38       4.68       2.75 |    100.00 
-----------+------------------------------------------------------------------+----------
    30-<40 |    56,699    954,074    677,537    306,197    128,735     74,767 | 2,198,009 
           |      2.58      43.41      30.83      13.93       5.86       3.40 |    100.00 
-----------+------------------------------------------------------------------+----------
    40-<50 |    28,400    702,301    729,151    367,562    147,728     80,592 | 2,055,734 
           |      1.38      34.16      35.47      17.88       7.19       3.92 |    100.00 
-----------+------------------------------------------------------------------+----------
    50-<60 |    23,125    632,441    838,658    475,755    192,336     99,775 | 2,262,090 
           |      1.02      27.96      37.07      21.03       8.50       4.41 |    100.00 
-----------+------------------------------------------------------------------+----------
    60-<70 |    23,143    524,722    725,514    407,638    155,980     73,016 | 1,910,013 
           |      1.21      27.47      37.98      21.34       8.17       3.82 |    100.00 
-----------+------------------------------------------------------------------+----------
    70-<80 |    25,121    474,912    641,796    326,948    109,453     42,861 | 1,621,091 
           |      1.55      29.30      39.59      20.17       6.75       2.64 |    100.00 
-----------+------------------------------------------------------------------+----------
       80+ |    35,078    364,344    355,909    146,242     39,331     11,354 |   952,258 
           |      3.68      38.26      37.38      15.36       4.13       1.19 |    100.00 
-----------+------------------------------------------------------------------+----------
     Total |   310,994  4,664,052  4,420,940  2,230,374    863,689    435,411 |12,925,460 
           |      2.41      36.08      34.20      17.26       6.68       3.37 |    100.00 

. safetab agegroup smoke,         row  
15

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

   Grouped |          Smoking status
       age |     Never     Former    Current |     Total
-----------+---------------------------------+----------
    18-<30 | 1,689,408    387,353    590,869 | 2,667,630 
           |     63.33      14.52      22.15 |    100.00 
-----------+---------------------------------+----------
    30-<40 | 1,383,921    749,270    689,253 | 2,822,444 
           |     49.03      26.55      24.42 |    100.00 
-----------+---------------------------------+----------
    40-<50 | 1,145,610    824,439    557,401 | 2,527,450 
           |     45.33      32.62      22.05 |    100.00 
-----------+---------------------------------+----------
    50-<60 | 1,213,463    919,630    515,703 | 2,648,796 
           |     45.81      34.72      19.47 |    100.00 
-----------+---------------------------------+----------
    60-<70 |   920,982    911,214    303,868 | 2,136,064 
           |     43.12      42.66      14.23 |    100.00 
-----------+---------------------------------+----------
    70-<80 |   672,605    926,198    154,136 | 1,752,939 
           |     38.37      52.84       8.79 |    100.00 
-----------+---------------------------------+----------
       80+ |   449,062    557,716     43,003 | 1,049,781 
           |     42.78      53.13       4.10 |    100.00 
-----------+---------------------------------+----------
     Total | 7,475,051  5,275,820  2,854,233 |15,605,104 
           |     47.90      33.81      18.29 |    100.00 

. safetab agegroup ethnicity, row 
19

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

   Grouped |                       Ethnicity
       age |     White      Mixed  Asian or       Black      Other |     Total
-----------+-------------------------------------------------------+----------
    18-<30 | 1,692,683     57,811    221,871     82,576    109,273 | 2,164,214 
           |     78.21       2.67      10.25       3.82       5.05 |    100.00 
-----------+-------------------------------------------------------+----------
    30-<40 | 1,834,371     49,156    296,552     82,513     93,238 | 2,355,830 
           |     77.87       2.09      12.59       3.50       3.96 |    100.00 
-----------+-------------------------------------------------------+----------
    40-<50 | 1,662,082     34,921    229,414     83,495     68,812 | 2,078,724 
           |     79.96       1.68      11.04       4.02       3.31 |    100.00 
-----------+-------------------------------------------------------+----------
    50-<60 | 1,819,128     23,420    126,467     65,666     39,006 | 2,073,687 
           |     87.72       1.13       6.10       3.17       1.88 |    100.00 
-----------+-------------------------------------------------------+----------
    60-<70 | 1,505,710     10,391     87,178     27,290     21,684 | 1,652,253 
           |     91.13       0.63       5.28       1.65       1.31 |    100.00 
-----------+-------------------------------------------------------+----------
    70-<80 | 1,261,232      4,726     41,977     12,232     10,459 | 1,330,626 
           |     94.78       0.36       3.15       0.92       0.79 |    100.00 
-----------+-------------------------------------------------------+----------
       80+ |   689,972      2,442     22,962      9,079      4,775 |   729,230 
           |     94.62       0.33       3.15       1.25       0.65 |    100.00 
-----------+-------------------------------------------------------+----------
     Total |10,465,178    182,867  1,026,421    362,851    347,247 |12,384,564 
           |     84.50       1.48       8.29       2.93       2.80 |    100.00 

. safetab agegroup imd,           row 
13

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

   Grouped |          Index of Multiple Deprivation (IMD)
       age | 1 least d          2          3          4  5 most de |     Total
-----------+-------------------------------------------------------+----------
    18-<30 |   517,439    558,402    627,386    711,405    697,661 | 3,112,293 
           |     16.63      17.94      20.16      22.86      22.42 |    100.00 
-----------+-------------------------------------------------------+----------
    30-<40 |   491,255    542,796    593,813    675,702    644,373 | 2,947,939 
           |     16.66      18.41      20.14      22.92      21.86 |    100.00 
-----------+-------------------------------------------------------+----------
    40-<50 |   540,212    516,309    513,915    534,473    491,640 | 2,596,549 
           |     20.80      19.88      19.79      20.58      18.93 |    100.00 
-----------+-------------------------------------------------------+----------
    50-<60 |   598,693    569,533    545,902    528,208    453,859 | 2,696,195 
           |     22.21      21.12      20.25      19.59      16.83 |    100.00 
-----------+-------------------------------------------------------+----------
    60-<70 |   508,946    478,338    449,915    404,390    321,264 | 2,162,853 
           |     23.53      22.12      20.80      18.70      14.85 |    100.00 
-----------+-------------------------------------------------------+----------
    70-<80 |   458,302    413,090    372,326    305,702    216,145 | 1,765,565 
           |     25.96      23.40      21.09      17.31      12.24 |    100.00 
-----------+-------------------------------------------------------+----------
       80+ |   274,217    245,458    222,071    183,815    132,374 | 1,057,935 
           |     25.92      23.20      20.99      17.37      12.51 |    100.00 
-----------+-------------------------------------------------------+----------
     Total | 3,389,064  3,323,926  3,325,328  3,343,695  2,957,316 |16,339,329 
           |     20.74      20.34      20.35      20.46      18.10 |    100.00 

. safetab agegroup shield,    row 
16

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

   Grouped |  Probable shielding
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<30 | 2,465,848    646,445 | 3,112,293 
           |     79.23      20.77 |    100.00 
-----------+----------------------+----------
    30-<40 | 2,308,044    639,895 | 2,947,939 
           |     78.29      21.71 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,060,629    535,920 | 2,596,549 
           |     79.36      20.64 |    100.00 
-----------+----------------------+----------
    50-<60 | 2,112,426    583,769 | 2,696,195 
           |     78.35      21.65 |    100.00 
-----------+----------------------+----------
    60-<70 | 1,585,609    577,244 | 2,162,853 
           |     73.31      26.69 |    100.00 
-----------+----------------------+----------
    70-<80 | 1,158,652    606,913 | 1,765,565 
           |     65.62      34.38 |    100.00 
-----------+----------------------+----------
       80+ |   657,209    400,726 | 1,057,935 
           |     62.12      37.88 |    100.00 
-----------+----------------------+----------
     Total |12,348,417  3,990,912 |16,339,329 
           |     75.57      24.43 |    100.00 

. 
. safetab bmicat smoke,            row   
13

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

                     |          Smoking status
         Grouped BMI |     Never     Former    Current |     Total
---------------------+---------------------------------+----------
 Underweight (<18.5) |   149,680     68,581     84,813 |   303,074 
                     |     49.39      22.63      27.98 |    100.00 
---------------------+---------------------------------+----------
  Normal (18.5-24.9) | 2,295,988  1,419,466    898,672 | 4,614,126 
                     |     49.76      30.76      19.48 |    100.00 
---------------------+---------------------------------+----------
Overweight (25-29.9) | 1,991,568  1,708,425    693,978 | 4,393,971 
                     |     45.33      38.88      15.79 |    100.00 
---------------------+---------------------------------+----------
   Obese I (30-34.9) |   951,250    926,305    341,183 | 2,218,738 
                     |     42.87      41.75      15.38 |    100.00 
---------------------+---------------------------------+----------
  Obese II (35-39.9) |   366,318    358,914    133,891 |   859,123 
                     |     42.64      41.78      15.58 |    100.00 
---------------------+---------------------------------+----------
     Obese III (40+) |   185,953    178,985     67,963 |   432,901 
                     |     42.96      41.35      15.70 |    100.00 
---------------------+---------------------------------+----------
               Total | 5,940,757  4,660,676  2,220,500 |12,821,933 
                     |     46.33      36.35      17.32 |    100.00 

. safetab bmicat ethnicity,        row 
17

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

                     |                       Ethnicity
         Grouped BMI |     White      Mixed  Asian or       Black      Other |     Total
---------------------+-------------------------------------------------------+----------
 Underweight (<18.5) |   194,426      4,406     27,592      5,650     13,971 |   246,045 
                     |     79.02       1.79      11.21       2.30       5.68 |    100.00 
---------------------+-------------------------------------------------------+----------
  Normal (18.5-24.9) | 3,234,182     59,712    323,980     89,803    134,045 | 3,841,722 
                     |     84.19       1.55       8.43       2.34       3.49 |    100.00 
---------------------+-------------------------------------------------------+----------
Overweight (25-29.9) | 3,075,322     46,012    307,026    103,177     77,302 | 3,608,839 
                     |     85.22       1.27       8.51       2.86       2.14 |    100.00 
---------------------+-------------------------------------------------------+----------
   Obese I (30-34.9) | 1,550,029     21,931    125,411     57,705     29,301 | 1,784,377 
                     |     86.87       1.23       7.03       3.23       1.64 |    100.00 
---------------------+-------------------------------------------------------+----------
  Obese II (35-39.9) |   603,114      8,317     37,947     22,428      8,930 |   680,736 
                     |     88.60       1.22       5.57       3.29       1.31 |    100.00 
---------------------+-------------------------------------------------------+----------
     Obese III (40+) |   305,965      4,317     14,610     10,732      3,784 |   339,408 
                     |     90.15       1.27       4.30       3.16       1.11 |    100.00 
---------------------+-------------------------------------------------------+----------
               Total | 8,963,038    144,695    836,566    289,495    267,333 |10,501,127 
                     |     85.35       1.38       7.97       2.76       2.55 |    100.00 

. safetab bmicat imd,              row 
11

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

                     |          Index of Multiple Deprivation (IMD)
         Grouped BMI | 1 least d          2          3          4  5 most de |     Total
---------------------+-------------------------------------------------------+----------
 Underweight (<18.5) |    54,988     58,224     62,724     68,416     66,642 |   310,994 
                     |     17.68      18.72      20.17      22.00      21.43 |    100.00 
---------------------+-------------------------------------------------------+----------
  Normal (18.5-24.9) | 1,051,985    996,786    959,163    913,983    742,135 | 4,664,052 
                     |     22.56      21.37      20.57      19.60      15.91 |    100.00 
---------------------+-------------------------------------------------------+----------
Overweight (25-29.9) |   977,220    931,693    907,595    877,967    726,465 | 4,420,940 
                     |     22.10      21.07      20.53      19.86      16.43 |    100.00 
---------------------+-------------------------------------------------------+----------
   Obese I (30-34.9) |   426,900    439,766    454,595    475,036    434,077 | 2,230,374 
                     |     19.14      19.72      20.38      21.30      19.46 |    100.00 
---------------------+-------------------------------------------------------+----------
  Obese II (35-39.9) |   142,635    158,358    173,112    194,547    195,037 |   863,689 
                     |     16.51      18.34      20.04      22.53      22.58 |    100.00 
---------------------+-------------------------------------------------------+----------
     Obese III (40+) |    61,730     73,332     85,148    102,880    112,321 |   435,411 
                     |     14.18      16.84      19.56      23.63      25.80 |    100.00 
---------------------+-------------------------------------------------------+----------
               Total | 2,715,458  2,658,159  2,642,337  2,632,829  2,276,677 |12,925,460 
                     |     21.01      20.57      20.44      20.37      17.61 |    100.00 

. safetab bmicat hypertension, row 
20

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

                     |       Diagnosed
                     |     hypertension
         Grouped BMI |         0          1 |     Total
---------------------+----------------------+----------
 Underweight (<18.5) |   271,144     39,850 |   310,994 
                     |     87.19      12.81 |    100.00 
---------------------+----------------------+----------
  Normal (18.5-24.9) | 3,959,636    704,416 | 4,664,052 
                     |     84.90      15.10 |    100.00 
---------------------+----------------------+----------
Overweight (25-29.9) | 3,265,227  1,155,713 | 4,420,940 
                     |     73.86      26.14 |    100.00 
---------------------+----------------------+----------
   Obese I (30-34.9) | 1,464,560    765,814 | 2,230,374 
                     |     65.66      34.34 |    100.00 
---------------------+----------------------+----------
  Obese II (35-39.9) |   536,251    327,438 |   863,689 
                     |     62.09      37.91 |    100.00 
---------------------+----------------------+----------
     Obese III (40+) |   264,776    170,635 |   435,411 
                     |     60.81      39.19 |    100.00 
---------------------+----------------------+----------
               Total | 9,761,594  3,163,866 |12,925,460 
                     |     75.52      24.48 |    100.00 

. safetab bmicat shield,    row 
14

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

                     |  Probable shielding
         Grouped BMI |         0          1 |     Total
---------------------+----------------------+----------
 Underweight (<18.5) |   225,575     85,419 |   310,994 
                     |     72.53      27.47 |    100.00 
---------------------+----------------------+----------
  Normal (18.5-24.9) | 3,510,447  1,153,605 | 4,664,052 
                     |     75.27      24.73 |    100.00 
---------------------+----------------------+----------
Overweight (25-29.9) | 3,255,317  1,165,623 | 4,420,940 
                     |     73.63      26.37 |    100.00 
---------------------+----------------------+----------
   Obese I (30-34.9) | 1,586,671    643,703 | 2,230,374 
                     |     71.14      28.86 |    100.00 
---------------------+----------------------+----------
  Obese II (35-39.9) |   589,311    274,378 |   863,689 
                     |     68.23      31.77 |    100.00 
---------------------+----------------------+----------
     Obese III (40+) |   284,601    150,810 |   435,411 
                     |     65.36      34.64 |    100.00 
---------------------+----------------------+----------
               Total | 9,451,922  3,473,538 |12,925,460 
                     |     73.13      26.87 |    100.00 

. 
.                             
. safetab smoke ethnicity,        row 
16

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

     Smoking |                       Ethnicity
      status |     White      Mixed  Asian or       Black      Other |     Total
-------------+-------------------------------------------------------+----------
       Never | 4,478,309     95,318    712,240    234,154    205,680 | 5,725,701 
             |     78.21       1.66      12.44       4.09       3.59 |    100.00 
-------------+-------------------------------------------------------+----------
      Former | 3,814,747     41,505    153,769     64,814     60,539 | 4,135,374 
             |     92.25       1.00       3.72       1.57       1.46 |    100.00 
-------------+-------------------------------------------------------+----------
     Current | 1,948,426     37,276    113,039     47,251     57,763 | 2,203,755 
             |     88.41       1.69       5.13       2.14       2.62 |    100.00 
-------------+-------------------------------------------------------+----------
       Total |10,241,482    174,099    979,048    346,219    323,982 |12,064,830 
             |     84.89       1.44       8.11       2.87       2.69 |    100.00 

. safetab smoke imd,                      row 
10

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

     Smoking |          Index of Multiple Deprivation (IMD)
      status | 1 least d          2          3          4  5 most de |     Total
-------------+-------------------------------------------------------+----------
       Never | 1,752,690  1,611,048  1,529,777  1,456,721  1,124,815 | 7,475,051 
             |     23.45      21.55      20.47      19.49      15.05 |    100.00 
-------------+-------------------------------------------------------+----------
      Former | 1,181,530  1,148,064  1,108,949  1,022,239    815,038 | 5,275,820 
             |     22.40      21.76      21.02      19.38      15.45 |    100.00 
-------------+-------------------------------------------------------+----------
     Current |   336,965    438,190    547,743    707,101    824,234 | 2,854,233 
             |     11.81      15.35      19.19      24.77      28.88 |    100.00 
-------------+-------------------------------------------------------+----------
       Total | 3,271,185  3,197,302  3,186,469  3,186,061  2,764,087 |15,605,104 
             |     20.96      20.49      20.42      20.42      17.71 |    100.00 

. safetab smoke hypertension, row 
19

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

             |       Diagnosed
     Smoking |     hypertension
      status |         0          1 |     Total
-------------+----------------------+----------
       Never | 6,100,016  1,375,035 | 7,475,051 
             |     81.61      18.39 |    100.00 
-------------+----------------------+----------
      Former | 3,643,698  1,632,122 | 5,275,820 
             |     69.06      30.94 |    100.00 
-------------+----------------------+----------
     Current | 2,474,323    379,910 | 2,854,233 
             |     86.69      13.31 |    100.00 
-------------+----------------------+----------
       Total |12,218,037  3,387,067 |15,605,104 
             |     78.30      21.70 |    100.00 

. safetab smoke shield,    row 
13

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

     Smoking |  Probable shielding
      status |         0          1 |     Total
-------------+----------------------+----------
       Never | 5,841,592  1,633,459 | 7,475,051 
             |     78.15      21.85 |    100.00 
-------------+----------------------+----------
      Former | 3,680,772  1,595,048 | 5,275,820 
             |     69.77      30.23 |    100.00 
-------------+----------------------+----------
     Current | 2,133,147    721,086 | 2,854,233 
             |     74.74      25.26 |    100.00 
-------------+----------------------+----------
       Total |11,655,511  3,949,593 |15,605,104 
             |     74.69      25.31 |    100.00 

.                       
. safetab ethnicity imd,          row 
14

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

                      |          Index of Multiple Deprivation (IMD)
            Ethnicity | 1 least d          2          3          4  5 most de |     Total
----------------------+-------------------------------------------------------+----------
                White | 2,282,527  2,231,765  2,140,636  2,052,114  1,758,136 |10,465,178 
                      |     21.81      21.33      20.45      19.61      16.80 |    100.00 
----------------------+-------------------------------------------------------+----------
                Mixed |    24,701     29,942     35,661     44,209     48,354 |   182,867 
                      |     13.51      16.37      19.50      24.18      26.44 |    100.00 
----------------------+-------------------------------------------------------+----------
Asian or Asian Britis |    93,068    123,873    202,717    305,230    301,533 | 1,026,421 
                      |      9.07      12.07      19.75      29.74      29.38 |    100.00 
----------------------+-------------------------------------------------------+----------
                Black |    25,623     38,610     61,935     99,393    137,290 |   362,851 
                      |      7.06      10.64      17.07      27.39      37.84 |    100.00 
----------------------+-------------------------------------------------------+----------
                Other |    46,206     59,720     69,758     87,314     84,249 |   347,247 
                      |     13.31      17.20      20.09      25.14      24.26 |    100.00 
----------------------+-------------------------------------------------------+----------
                Total | 2,472,125  2,483,910  2,510,707  2,588,260  2,329,562 |12,384,564 
                      |     19.96      20.06      20.27      20.90      18.81 |    100.00 

. safetab shield imd,             row 
11

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

  Probable |          Index of Multiple Deprivation (IMD)
 shielding | 1 least d          2          3          4  5 most de |     Total
-----------+-------------------------------------------------------+----------
         0 | 2,539,613  2,505,111  2,520,819  2,548,442  2,234,432 |12,348,417 
           |     20.57      20.29      20.41      20.64      18.09 |    100.00 
-----------+-------------------------------------------------------+----------
         1 |   849,451    818,815    804,509    795,253    722,884 | 3,990,912 
           |     21.28      20.52      20.16      19.93      18.11 |    100.00 
-----------+-------------------------------------------------------+----------
     Total | 3,389,064  3,323,926  3,325,328  3,343,695  2,957,316 |16,339,329 
           |     20.74      20.34      20.35      20.46      18.10 |    100.00 

. 
. safetab shield ethnicity,               row 
17

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

  Probable |                       Ethnicity
 shielding |     White      Mixed  Asian or       Black      Other |     Total
-----------+-------------------------------------------------------+----------
         0 | 7,689,913    144,997    865,894    294,862    308,554 | 9,304,220 
           |     82.65       1.56       9.31       3.17       3.32 |    100.00 
-----------+-------------------------------------------------------+----------
         1 | 2,775,265     37,870    160,527     67,989     38,693 | 3,080,344 
           |     90.10       1.23       5.21       2.21       1.26 |    100.00 
-----------+-------------------------------------------------------+----------
     Total |10,465,178    182,867  1,026,421    362,851    347,247 |12,384,564 
           |     84.50       1.48       8.29       2.93       2.80 |    100.00 

. 
. 
. 
. * Relationships with age
. foreach var of varlist  asthma                                          ///
>                                         chronic_respiratory_disease     ///
>                                         chronic_cardiac_disease         ///
>                                         diabetes                                                ///
>                                         chronic_liver_disease           ///
>                                         other_neuro                     ///
>                                         stroke_dementia ///
>                                         ra_sle_psoriasis                                ///
>                                         other_immuno                            ///
>                                         organ_trans                     /// 
>                                         asplenia                        /// 
>                                         cancer_exhaem_cat                                               ///
>                                         cancer_haem_cat                                                 ///
>                                         reduced_kidney_function_cat ///
>                                         hypertension            ///             
>                                                                                 {
  2. 
.                 
.         safetab agegroup `var', row 
  3.  }
16

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

   Grouped |    Asthma category
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<30 | 2,519,660    592,633 | 3,112,293 
           |     80.96      19.04 |    100.00 
-----------+----------------------+----------
    30-<40 | 2,426,361    521,578 | 2,947,939 
           |     82.31      17.69 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,180,200    416,349 | 2,596,549 
           |     83.97      16.03 |    100.00 
-----------+----------------------+----------
    50-<60 | 2,294,307    401,888 | 2,696,195 
           |     85.09      14.91 |    100.00 
-----------+----------------------+----------
    60-<70 | 1,866,343    296,510 | 2,162,853 
           |     86.29      13.71 |    100.00 
-----------+----------------------+----------
    70-<80 | 1,537,311    228,254 | 1,765,565 
           |     87.07      12.93 |    100.00 
-----------+----------------------+----------
       80+ |   927,413    130,522 | 1,057,935 
           |     87.66      12.34 |    100.00 
-----------+----------------------+----------
     Total |13,751,595  2,587,734 |16,339,329 
           |     84.16      15.84 |    100.00 
37

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |  Chronic Respiratory
   Grouped |       Diseases
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<30 | 3,103,228      9,065 | 3,112,293 
           |     99.71       0.29 |    100.00 
-----------+----------------------+----------
    30-<40 | 2,935,343     12,596 | 2,947,939 
           |     99.57       0.43 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,564,192     32,357 | 2,596,549 
           |     98.75       1.25 |    100.00 
-----------+----------------------+----------
    50-<60 | 2,603,663     92,532 | 2,696,195 
           |     96.57       3.43 |    100.00 
-----------+----------------------+----------
    60-<70 | 2,000,934    161,919 | 2,162,853 
           |     92.51       7.49 |    100.00 
-----------+----------------------+----------
    70-<80 | 1,551,849    213,716 | 1,765,565 
           |     87.90      12.10 |    100.00 
-----------+----------------------+----------
       80+ |   915,040    142,895 | 1,057,935 
           |     86.49      13.51 |    100.00 
-----------+----------------------+----------
     Total |15,674,249    665,080 |16,339,329 
           |     95.93       4.07 |    100.00 
33

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |    Chronic Cardiac
   Grouped |       Diseases
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<30 | 3,092,016     20,277 | 3,112,293 
           |     99.35       0.65 |    100.00 
-----------+----------------------+----------
    30-<40 | 2,926,494     21,445 | 2,947,939 
           |     99.27       0.73 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,551,523     45,026 | 2,596,549 
           |     98.27       1.73 |    100.00 
-----------+----------------------+----------
    50-<60 | 2,565,787    130,408 | 2,696,195 
           |     95.16       4.84 |    100.00 
-----------+----------------------+----------
    60-<70 | 1,935,436    227,417 | 2,162,853 
           |     89.49      10.51 |    100.00 
-----------+----------------------+----------
    70-<80 | 1,434,363    331,202 | 1,765,565 
           |     81.24      18.76 |    100.00 
-----------+----------------------+----------
       80+ |   728,157    329,778 | 1,057,935 
           |     68.83      31.17 |    100.00 
-----------+----------------------+----------
     Total |15,233,776  1,105,553 |16,339,329 
           |     93.23       6.77 |    100.00 
18

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

   Grouped |       Diabetes
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<30 | 3,076,986     35,307 | 3,112,293 
           |     98.87       1.13 |    100.00 
-----------+----------------------+----------
    30-<40 | 2,873,272     74,667 | 2,947,939 
           |     97.47       2.53 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,435,367    161,182 | 2,596,549 
           |     93.79       6.21 |    100.00 
-----------+----------------------+----------
    50-<60 | 2,389,764    306,431 | 2,696,195 
           |     88.63      11.37 |    100.00 
-----------+----------------------+----------
    60-<70 | 1,777,513    385,340 | 2,162,853 
           |     82.18      17.82 |    100.00 
-----------+----------------------+----------
    70-<80 | 1,364,484    401,081 | 1,765,565 
           |     77.28      22.72 |    100.00 
-----------+----------------------+----------
       80+ |   782,810    275,125 | 1,057,935 
           |     73.99      26.01 |    100.00 
-----------+----------------------+----------
     Total |14,700,196  1,639,133 |16,339,329 
           |     89.97      10.03 |    100.00 
31

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

   Grouped | Chronic liver disease
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<30 | 3,109,321      2,972 | 3,112,293 
           |     99.90       0.10 |    100.00 
-----------+----------------------+----------
    30-<40 | 2,939,044      8,895 | 2,947,939 
           |     99.70       0.30 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,581,023     15,526 | 2,596,549 
           |     99.40       0.60 |    100.00 
-----------+----------------------+----------
    50-<60 | 2,672,655     23,540 | 2,696,195 
           |     99.13       0.87 |    100.00 
-----------+----------------------+----------
    60-<70 | 2,138,909     23,944 | 2,162,853 
           |     98.89       1.11 |    100.00 
-----------+----------------------+----------
    70-<80 | 1,748,271     17,294 | 1,765,565 
           |     99.02       0.98 |    100.00 
-----------+----------------------+----------
       80+ | 1,051,335      6,600 | 1,057,935 
           |     99.38       0.62 |    100.00 
-----------+----------------------+----------
     Total |16,240,558     98,771 |16,339,329 
           |     99.40       0.60 |    100.00 
21

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

   Grouped | Neurological disease
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<30 | 3,100,857     11,436 | 3,112,293 
           |     99.63       0.37 |    100.00 
-----------+----------------------+----------
    30-<40 | 2,934,056     13,883 | 2,947,939 
           |     99.53       0.47 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,579,270     17,279 | 2,596,549 
           |     99.33       0.67 |    100.00 
-----------+----------------------+----------
    50-<60 | 2,669,816     26,379 | 2,696,195 
           |     99.02       0.98 |    100.00 
-----------+----------------------+----------
    60-<70 | 2,132,664     30,189 | 2,162,853 
           |     98.60       1.40 |    100.00 
-----------+----------------------+----------
    70-<80 | 1,728,636     36,929 | 1,765,565 
           |     97.91       2.09 |    100.00 
-----------+----------------------+----------
       80+ | 1,030,508     27,427 | 1,057,935 
           |     97.41       2.59 |    100.00 
-----------+----------------------+----------
     Total |16,175,807    163,522 |16,339,329 
           |     99.00       1.00 |    100.00 
25

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

   Grouped |  Stroke or dementia
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<30 | 3,109,070      3,223 | 3,112,293 
           |     99.90       0.10 |    100.00 
-----------+----------------------+----------
    30-<40 | 2,942,169      5,770 | 2,947,939 
           |     99.80       0.20 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,582,982     13,567 | 2,596,549 
           |     99.48       0.52 |    100.00 
-----------+----------------------+----------
    50-<60 | 2,659,342     36,853 | 2,696,195 
           |     98.63       1.37 |    100.00 
-----------+----------------------+----------
    60-<70 | 2,097,223     65,630 | 2,162,853 
           |     96.97       3.03 |    100.00 
-----------+----------------------+----------
    70-<80 | 1,652,986    112,579 | 1,765,565 
           |     93.62       6.38 |    100.00 
-----------+----------------------+----------
       80+ |   908,364    149,571 | 1,057,935 
           |     85.86      14.14 |    100.00 
-----------+----------------------+----------
     Total |15,952,136    387,193 |16,339,329 
           |     97.63       2.37 |    100.00 
26

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

   Grouped |  Autoimmune disease
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<30 | 3,044,627     67,666 | 3,112,293 
           |     97.83       2.17 |    100.00 
-----------+----------------------+----------
    30-<40 | 2,842,534    105,405 | 2,947,939 
           |     96.42       3.58 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,476,437    120,112 | 2,596,549 
           |     95.37       4.63 |    100.00 
-----------+----------------------+----------
    50-<60 | 2,539,401    156,794 | 2,696,195 
           |     94.18       5.82 |    100.00 
-----------+----------------------+----------
    60-<70 | 2,012,581    150,272 | 2,162,853 
           |     93.05       6.95 |    100.00 
-----------+----------------------+----------
    70-<80 | 1,627,742    137,823 | 1,765,565 
           |     92.19       7.81 |    100.00 
-----------+----------------------+----------
       80+ |   980,238     77,697 | 1,057,935 
           |     92.66       7.34 |    100.00 
-----------+----------------------+----------
     Total |15,523,560    815,769 |16,339,329 
           |     95.01       4.99 |    100.00 
22

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |   Immunosuppressed
           |     (combination
   Grouped |      algorithm)
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<30 | 3,062,474     49,819 | 3,112,293 
           |     98.40       1.60 |    100.00 
-----------+----------------------+----------
    30-<40 | 2,835,608    112,331 | 2,947,939 
           |     96.19       3.81 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,525,162     71,387 | 2,596,549 
           |     97.25       2.75 |    100.00 
-----------+----------------------+----------
    50-<60 | 2,670,084     26,111 | 2,696,195 
           |     99.03       0.97 |    100.00 
-----------+----------------------+----------
    60-<70 | 2,152,519     10,334 | 2,162,853 
           |     99.52       0.48 |    100.00 
-----------+----------------------+----------
    70-<80 | 1,760,287      5,278 | 1,765,565 
           |     99.70       0.30 |    100.00 
-----------+----------------------+----------
       80+ | 1,055,782      2,153 | 1,057,935 
           |     99.80       0.20 |    100.00 
-----------+----------------------+----------
     Total |16,061,916    277,413 |16,339,329 
           |     98.30       1.70 |    100.00 
21

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |      Solid organ
   Grouped |      transplant
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<30 | 3,111,118      1,175 | 3,112,293 
           |     99.96       0.04 |    100.00 
-----------+----------------------+----------
    30-<40 | 2,945,882      2,057 | 2,947,939 
           |     99.93       0.07 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,593,597      2,952 | 2,596,549 
           |     99.89       0.11 |    100.00 
-----------+----------------------+----------
    50-<60 | 2,691,504      4,691 | 2,696,195 
           |     99.83       0.17 |    100.00 
-----------+----------------------+----------
    60-<70 | 2,158,359      4,494 | 2,162,853 
           |     99.79       0.21 |    100.00 
-----------+----------------------+----------
    70-<80 | 1,762,967      2,598 | 1,765,565 
           |     99.85       0.15 |    100.00 
-----------+----------------------+----------
       80+ | 1,057,298        637 | 1,057,935 
           |     99.94       0.06 |    100.00 
-----------+----------------------+----------
     Total |16,320,725     18,604 |16,339,329 
           |     99.89       0.11 |    100.00 
18

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

   Grouped |       Asplenia
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<30 | 3,111,180      1,113 | 3,112,293 
           |     99.96       0.04 |    100.00 
-----------+----------------------+----------
    30-<40 | 2,945,819      2,120 | 2,947,939 
           |     99.93       0.07 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,593,525      3,024 | 2,596,549 
           |     99.88       0.12 |    100.00 
-----------+----------------------+----------
    50-<60 | 2,691,096      5,099 | 2,696,195 
           |     99.81       0.19 |    100.00 
-----------+----------------------+----------
    60-<70 | 2,157,954      4,899 | 2,162,853 
           |     99.77       0.23 |    100.00 
-----------+----------------------+----------
    70-<80 | 1,761,047      4,518 | 1,765,565 
           |     99.74       0.26 |    100.00 
-----------+----------------------+----------
       80+ | 1,055,581      2,354 | 1,057,935 
           |     99.78       0.22 |    100.00 
-----------+----------------------+----------
     Total |16,316,202     23,127 |16,339,329 
           |     99.86       0.14 |    100.00 
27

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

   Grouped |          Non-haematological cancer
       age |     Never  Last year  2-5 years   5+ years |     Total
-----------+--------------------------------------------+----------
    18-<30 | 3,105,867        809      2,120      3,497 | 3,112,293 
           |     99.79       0.03       0.07       0.11 |    100.00 
-----------+--------------------------------------------+----------
    30-<40 | 2,929,162      2,259      6,612      9,906 | 2,947,939 
           |     99.36       0.08       0.22       0.34 |    100.00 
-----------+--------------------------------------------+----------
    40-<50 | 2,555,504      4,804     13,462     22,779 | 2,596,549 
           |     98.42       0.19       0.52       0.88 |    100.00 
-----------+--------------------------------------------+----------
    50-<60 | 2,592,423     11,458     33,661     58,653 | 2,696,195 
           |     96.15       0.42       1.25       2.18 |    100.00 
-----------+--------------------------------------------+----------
    60-<70 | 1,990,347     18,599     51,928    101,979 | 2,162,853 
           |     92.02       0.86       2.40       4.72 |    100.00 
-----------+--------------------------------------------+----------
    70-<80 | 1,515,977     21,652     65,398    162,538 | 1,765,565 
           |     85.86       1.23       3.70       9.21 |    100.00 
-----------+--------------------------------------------+----------
       80+ |   868,687     13,228     38,927    137,093 | 1,057,935 
           |     82.11       1.25       3.68      12.96 |    100.00 
-----------+--------------------------------------------+----------
     Total |15,557,967     72,809    212,108    496,445 |16,339,329 
           |     95.22       0.45       1.30       3.04 |    100.00 
25

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

   Grouped |            Haematological cancer
       age |     Never  Last year  2-5 years   5+ years |     Total
-----------+--------------------------------------------+----------
    18-<30 | 3,108,247        276        944      2,826 | 3,112,293 
           |     99.87       0.01       0.03       0.09 |    100.00 
-----------+--------------------------------------------+----------
    30-<40 | 2,942,693        355      1,082      3,809 | 2,947,939 
           |     99.82       0.01       0.04       0.13 |    100.00 
-----------+--------------------------------------------+----------
    40-<50 | 2,589,568        465      1,461      5,055 | 2,596,549 
           |     99.73       0.02       0.06       0.19 |    100.00 
-----------+--------------------------------------------+----------
    50-<60 | 2,683,617      1,098      3,261      8,219 | 2,696,195 
           |     99.53       0.04       0.12       0.30 |    100.00 
-----------+--------------------------------------------+----------
    60-<70 | 2,144,453      1,799      5,529     11,072 | 2,162,853 
           |     99.15       0.08       0.26       0.51 |    100.00 
-----------+--------------------------------------------+----------
    70-<80 | 1,739,532      2,573      7,891     15,569 | 1,765,565 
           |     98.53       0.15       0.45       0.88 |    100.00 
-----------+--------------------------------------------+----------
       80+ | 1,039,103      1,705      5,406     11,721 | 1,057,935 
           |     98.22       0.16       0.51       1.11 |    100.00 
-----------+--------------------------------------------+----------
     Total |16,247,213      8,271     25,574     58,271 |16,339,329 
           |     99.44       0.05       0.16       0.36 |    100.00 
37

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

   Grouped |     Reduced kidney function
       age |      None  Stage 3a/  Stage 4/5 |     Total
-----------+---------------------------------+----------
    18-<30 | 3,110,517      1,235        541 | 3,112,293 
           |     99.94       0.04       0.02 |    100.00 
-----------+---------------------------------+----------
    30-<40 | 2,942,640      4,099      1,200 | 2,947,939 
           |     99.82       0.14       0.04 |    100.00 
-----------+---------------------------------+----------
    40-<50 | 2,581,805     12,605      2,139 | 2,596,549 
           |     99.43       0.49       0.08 |    100.00 
-----------+---------------------------------+----------
    50-<60 | 2,643,729     47,887      4,579 | 2,696,195 
           |     98.05       1.78       0.17 |    100.00 
-----------+---------------------------------+----------
    60-<70 | 2,030,585    124,757      7,511 | 2,162,853 
           |     93.88       5.77       0.35 |    100.00 
-----------+---------------------------------+----------
    70-<80 | 1,440,850    308,203     16,512 | 1,765,565 
           |     81.61      17.46       0.94 |    100.00 
-----------+---------------------------------+----------
       80+ |   587,301    429,778     40,856 | 1,057,935 
           |     55.51      40.62       3.86 |    100.00 
-----------+---------------------------------+----------
     Total |15,337,427    928,564     73,338 |16,339,329 
           |     93.87       5.68       0.45 |    100.00 
22

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |       Diagnosed
   Grouped |     hypertension
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<30 | 3,092,659     19,634 | 3,112,293 
           |     99.37       0.63 |    100.00 
-----------+----------------------+----------
    30-<40 | 2,872,840     75,099 | 2,947,939 
           |     97.45       2.55 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,357,391    239,158 | 2,596,549 
           |     90.79       9.21 |    100.00 
-----------+----------------------+----------
    50-<60 | 2,118,323    577,872 | 2,696,195 
           |     78.57      21.43 |    100.00 
-----------+----------------------+----------
    60-<70 | 1,358,046    804,807 | 2,162,853 
           |     62.79      37.21 |    100.00 
-----------+----------------------+----------
    70-<80 |   812,952    952,613 | 1,765,565 
           |     46.04      53.96 |    100.00 
-----------+----------------------+----------
       80+ |   331,484    726,451 | 1,057,935 
           |     31.33      68.67 |    100.00 
-----------+----------------------+----------
     Total |12,943,695  3,395,634 |16,339,329 
           |     79.22      20.78 |    100.00 

. 
. 
.  * Relationships with sex
. foreach var of varlist asthma                                           ///
>                                         chronic_respiratory_disease     ///
>                                         chronic_cardiac_disease         ///
>                                         diabetes                                                ///
>                                         chronic_liver_disease           ///
>                                         other_neuro                     ///
>                                         stroke_dementia ///
>                                         ra_sle_psoriasis                                ///
>                                         other_immuno                            ///
>                                         organ_trans                     /// 
>                                         asplenia                        /// 
>                                         cancer_exhaem_cat                                               ///
>                                         cancer_haem_cat                                                 ///
>                                         reduced_kidney_function_cat ///
>                                         hypertension                     ///    
>                                                                                 {
  2.                                                 
.         safetab male `var', row 
  3. }
12

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |    Asthma category
      Male |         0          1 |     Total
-----------+----------------------+----------
         0 | 6,910,711  1,384,302 | 8,295,013 
           |     83.31      16.69 |    100.00 
-----------+----------------------+----------
         1 | 6,840,884  1,203,432 | 8,044,316 
           |     85.04      14.96 |    100.00 
-----------+----------------------+----------
     Total |13,751,595  2,587,734 |16,339,329 
           |     84.16      15.84 |    100.00 
33

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |  Chronic Respiratory
           |       Diseases
      Male |         0          1 |     Total
-----------+----------------------+----------
         0 | 7,965,537    329,476 | 8,295,013 
           |     96.03       3.97 |    100.00 
-----------+----------------------+----------
         1 | 7,708,712    335,604 | 8,044,316 
           |     95.83       4.17 |    100.00 
-----------+----------------------+----------
     Total |15,674,249    665,080 |16,339,329 
           |     95.93       4.07 |    100.00 
29

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |    Chronic Cardiac
           |       Diseases
      Male |         0          1 |     Total
-----------+----------------------+----------
         0 | 7,852,951    442,062 | 8,295,013 
           |     94.67       5.33 |    100.00 
-----------+----------------------+----------
         1 | 7,380,825    663,491 | 8,044,316 
           |     91.75       8.25 |    100.00 
-----------+----------------------+----------
     Total |15,233,776  1,105,553 |16,339,329 
           |     93.23       6.77 |    100.00 
14

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |       Diabetes
      Male |         0          1 |     Total
-----------+----------------------+----------
         0 | 7,532,491    762,522 | 8,295,013 
           |     90.81       9.19 |    100.00 
-----------+----------------------+----------
         1 | 7,167,705    876,611 | 8,044,316 
           |     89.10      10.90 |    100.00 
-----------+----------------------+----------
     Total |14,700,196  1,639,133 |16,339,329 
           |     89.97      10.03 |    100.00 
27

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           | Chronic liver disease
      Male |         0          1 |     Total
-----------+----------------------+----------
         0 | 8,252,630     42,383 | 8,295,013 
           |     99.49       0.51 |    100.00 
-----------+----------------------+----------
         1 | 7,987,928     56,388 | 8,044,316 
           |     99.30       0.70 |    100.00 
-----------+----------------------+----------
     Total |16,240,558     98,771 |16,339,329 
           |     99.40       0.60 |    100.00 
17

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           | Neurological disease
      Male |         0          1 |     Total
-----------+----------------------+----------
         0 | 8,209,951     85,062 | 8,295,013 
           |     98.97       1.03 |    100.00 
-----------+----------------------+----------
         1 | 7,965,856     78,460 | 8,044,316 
           |     99.02       0.98 |    100.00 
-----------+----------------------+----------
     Total |16,175,807    163,522 |16,339,329 
           |     99.00       1.00 |    100.00 
21

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |  Stroke or dementia
      Male |         0          1 |     Total
-----------+----------------------+----------
         0 | 8,108,868    186,145 | 8,295,013 
           |     97.76       2.24 |    100.00 
-----------+----------------------+----------
         1 | 7,843,268    201,048 | 8,044,316 
           |     97.50       2.50 |    100.00 
-----------+----------------------+----------
     Total |15,952,136    387,193 |16,339,329 
           |     97.63       2.37 |    100.00 
22

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |  Autoimmune disease
      Male |         0          1 |     Total
-----------+----------------------+----------
         0 | 7,837,302    457,711 | 8,295,013 
           |     94.48       5.52 |    100.00 
-----------+----------------------+----------
         1 | 7,686,258    358,058 | 8,044,316 
           |     95.55       4.45 |    100.00 
-----------+----------------------+----------
     Total |15,523,560    815,769 |16,339,329 
           |     95.01       4.99 |    100.00 
18

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |   Immunosuppressed
           |     (combination
           |      algorithm)
      Male |         0          1 |     Total
-----------+----------------------+----------
         0 | 8,078,572    216,441 | 8,295,013 
           |     97.39       2.61 |    100.00 
-----------+----------------------+----------
         1 | 7,983,344     60,972 | 8,044,316 
           |     99.24       0.76 |    100.00 
-----------+----------------------+----------
     Total |16,061,916    277,413 |16,339,329 
           |     98.30       1.70 |    100.00 
17

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |      Solid organ
           |      transplant
      Male |         0          1 |     Total
-----------+----------------------+----------
         0 | 8,287,481      7,532 | 8,295,013 
           |     99.91       0.09 |    100.00 
-----------+----------------------+----------
         1 | 8,033,244     11,072 | 8,044,316 
           |     99.86       0.14 |    100.00 
-----------+----------------------+----------
     Total |16,320,725     18,604 |16,339,329 
           |     99.89       0.11 |    100.00 
14

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |       Asplenia
      Male |         0          1 |     Total
-----------+----------------------+----------
         0 | 8,284,907     10,106 | 8,295,013 
           |     99.88       0.12 |    100.00 
-----------+----------------------+----------
         1 | 8,031,295     13,021 | 8,044,316 
           |     99.84       0.16 |    100.00 
-----------+----------------------+----------
     Total |16,316,202     23,127 |16,339,329 
           |     99.86       0.14 |    100.00 
23

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |          Non-haematological cancer
      Male |     Never  Last year  2-5 years   5+ years |     Total
-----------+--------------------------------------------+----------
         0 | 7,850,461     35,355    107,920    301,277 | 8,295,013 
           |     94.64       0.43       1.30       3.63 |    100.00 
-----------+--------------------------------------------+----------
         1 | 7,707,506     37,454    104,188    195,168 | 8,044,316 
           |     95.81       0.47       1.30       2.43 |    100.00 
-----------+--------------------------------------------+----------
     Total |15,557,967     72,809    212,108    496,445 |16,339,329 
           |     95.22       0.45       1.30       3.04 |    100.00 
21

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |            Haematological cancer
      Male |     Never  Last year  2-5 years   5+ years |     Total
-----------+--------------------------------------------+----------
         0 | 8,253,694      3,571     11,096     26,652 | 8,295,013 
           |     99.50       0.04       0.13       0.32 |    100.00 
-----------+--------------------------------------------+----------
         1 | 7,993,519      4,700     14,478     31,619 | 8,044,316 
           |     99.37       0.06       0.18       0.39 |    100.00 
-----------+--------------------------------------------+----------
     Total |16,247,213      8,271     25,574     58,271 |16,339,329 
           |     99.44       0.05       0.16       0.36 |    100.00 
33

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |     Reduced kidney function
      Male |      None  Stage 3a/  Stage 4/5 |     Total
-----------+---------------------------------+----------
         0 | 7,728,312    530,061     36,640 | 8,295,013 
           |     93.17       6.39       0.44 |    100.00 
-----------+---------------------------------+----------
         1 | 7,609,115    398,503     36,698 | 8,044,316 
           |     94.59       4.95       0.46 |    100.00 
-----------+---------------------------------+----------
     Total |15,337,427    928,564     73,338 |16,339,329 
           |     93.87       5.68       0.45 |    100.00 
18

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |       Diagnosed
           |     hypertension
      Male |         0          1 |     Total
-----------+----------------------+----------
         0 | 6,579,499  1,715,514 | 8,295,013 
           |     79.32      20.68 |    100.00 
-----------+----------------------+----------
         1 | 6,364,196  1,680,120 | 8,044,316 
           |     79.11      20.89 |    100.00 
-----------+----------------------+----------
     Total |12,943,695  3,395,634 |16,339,329 
           |     79.22      20.78 |    100.00 

. 
.  * Relationships with smoking
. foreach var of varlist  asthma                                          ///
>                                         chronic_respiratory_disease     ///
>                                         chronic_cardiac_disease         ///
>                                         diabetes                                                ///
>                                         chronic_liver_disease           ///
>                                         other_neuro                     ///
>                                         stroke_dementia ///
>                                         ra_sle_psoriasis                                ///
>                                         other_immuno                            ///
>                                         organ_trans                     /// 
>                                         asplenia                        /// 
>                                         cancer_exhaem_cat                                               ///
>                                         cancer_haem_cat                                                 ///
>                                         reduced_kidney_function_cat ///
>                                         hypertension                            ///
>                                         {
  2.         
.         safetab smoke `var', row 
  3. }
13

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

     Smoking |    Asthma category
      status |         0          1 |     Total
-------------+----------------------+----------
       Never | 6,321,997  1,153,054 | 7,475,051 
             |     84.57      15.43 |    100.00 
-------------+----------------------+----------
      Former | 4,357,816    918,004 | 5,275,820 
             |     82.60      17.40 |    100.00 
-------------+----------------------+----------
     Current | 2,371,460    482,773 | 2,854,233 
             |     83.09      16.91 |    100.00 
-------------+----------------------+----------
       Total |13,051,273  2,553,831 |15,605,104 
             |     83.63      16.37 |    100.00 
34

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

             |  Chronic Respiratory
     Smoking |       Diseases
      status |         0          1 |     Total
-------------+----------------------+----------
       Never | 7,369,587    105,464 | 7,475,051 
             |     98.59       1.41 |    100.00 
-------------+----------------------+----------
      Former | 4,897,173    378,647 | 5,275,820 
             |     92.82       7.18 |    100.00 
-------------+----------------------+----------
     Current | 2,674,589    179,644 | 2,854,233 
             |     93.71       6.29 |    100.00 
-------------+----------------------+----------
       Total |14,941,349    663,755 |15,605,104 
             |     95.75       4.25 |    100.00 
30

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

             |    Chronic Cardiac
     Smoking |       Diseases
      status |         0          1 |     Total
-------------+----------------------+----------
       Never | 7,115,557    359,494 | 7,475,051 
             |     95.19       4.81 |    100.00 
-------------+----------------------+----------
      Former | 4,673,432    602,388 | 5,275,820 
             |     88.58      11.42 |    100.00 
-------------+----------------------+----------
     Current | 2,715,018    139,215 | 2,854,233 
             |     95.12       4.88 |    100.00 
-------------+----------------------+----------
       Total |14,504,007  1,101,097 |15,605,104 
             |     92.94       7.06 |    100.00 
15

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

     Smoking |       Diabetes
      status |         0          1 |     Total
-------------+----------------------+----------
       Never | 6,837,005    638,046 | 7,475,051 
             |     91.46       8.54 |    100.00 
-------------+----------------------+----------
      Former | 4,505,492    770,328 | 5,275,820 
             |     85.40      14.60 |    100.00 
-------------+----------------------+----------
     Current | 2,628,631    225,602 | 2,854,233 
             |     92.10       7.90 |    100.00 
-------------+----------------------+----------
       Total |13,971,128  1,633,976 |15,605,104 
             |     89.53      10.47 |    100.00 
28

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

     Smoking | Chronic liver disease
      status |         0          1 |     Total
-------------+----------------------+----------
       Never | 7,446,374     28,677 | 7,475,051 
             |     99.62       0.38 |    100.00 
-------------+----------------------+----------
      Former | 5,235,659     40,161 | 5,275,820 
             |     99.24       0.76 |    100.00 
-------------+----------------------+----------
     Current | 2,824,993     29,240 | 2,854,233 
             |     98.98       1.02 |    100.00 
-------------+----------------------+----------
       Total |15,507,026     98,078 |15,605,104 
             |     99.37       0.63 |    100.00 
18

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

     Smoking | Neurological disease
      status |         0          1 |     Total
-------------+----------------------+----------
       Never | 7,402,598     72,453 | 7,475,051 
             |     99.03       0.97 |    100.00 
-------------+----------------------+----------
      Former | 5,206,814     69,006 | 5,275,820 
             |     98.69       1.31 |    100.00 
-------------+----------------------+----------
     Current | 2,833,940     20,293 | 2,854,233 
             |     99.29       0.71 |    100.00 
-------------+----------------------+----------
       Total |15,443,352    161,752 |15,605,104 
             |     98.96       1.04 |    100.00 
22

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

     Smoking |  Stroke or dementia
      status |         0          1 |     Total
-------------+----------------------+----------
       Never | 7,344,269    130,782 | 7,475,051 
             |     98.25       1.75 |    100.00 
-------------+----------------------+----------
      Former | 5,071,310    204,510 | 5,275,820 
             |     96.12       3.88 |    100.00 
-------------+----------------------+----------
     Current | 2,803,646     50,587 | 2,854,233 
             |     98.23       1.77 |    100.00 
-------------+----------------------+----------
       Total |15,219,225    385,879 |15,605,104 
             |     97.53       2.47 |    100.00 
23

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

     Smoking |  Autoimmune disease
      status |         0          1 |     Total
-------------+----------------------+----------
       Never | 7,182,581    292,470 | 7,475,051 
             |     96.09       3.91 |    100.00 
-------------+----------------------+----------
      Former | 4,918,622    357,198 | 5,275,820 
             |     93.23       6.77 |    100.00 
-------------+----------------------+----------
     Current | 2,696,230    158,003 | 2,854,233 
             |     94.46       5.54 |    100.00 
-------------+----------------------+----------
       Total |14,797,433    807,671 |15,605,104 
             |     94.82       5.18 |    100.00 
19

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

             |   Immunosuppressed
             |     (combination
     Smoking |      algorithm)
      status |         0          1 |     Total
-------------+----------------------+----------
       Never | 7,345,914    129,137 | 7,475,051 
             |     98.27       1.73 |    100.00 
-------------+----------------------+----------
      Former | 5,184,905     90,915 | 5,275,820 
             |     98.28       1.72 |    100.00 
-------------+----------------------+----------
     Current | 2,799,275     54,958 | 2,854,233 
             |     98.07       1.93 |    100.00 
-------------+----------------------+----------
       Total |15,330,094    275,010 |15,605,104 
             |     98.24       1.76 |    100.00 
18

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

             |      Solid organ
     Smoking |      transplant
      status |         0          1 |     Total
-------------+----------------------+----------
       Never | 7,466,427      8,624 | 7,475,051 
             |     99.88       0.12 |    100.00 
-------------+----------------------+----------
      Former | 5,267,942      7,878 | 5,275,820 
             |     99.85       0.15 |    100.00 
-------------+----------------------+----------
     Current | 2,852,256      1,977 | 2,854,233 
             |     99.93       0.07 |    100.00 
-------------+----------------------+----------
       Total |15,586,625     18,479 |15,605,104 
             |     99.88       0.12 |    100.00 
15

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

     Smoking |       Asplenia
      status |         0          1 |     Total
-------------+----------------------+----------
       Never | 7,466,553      8,498 | 7,475,051 
             |     99.89       0.11 |    100.00 
-------------+----------------------+----------
      Former | 5,265,747     10,073 | 5,275,820 
             |     99.81       0.19 |    100.00 
-------------+----------------------+----------
     Current | 2,849,868      4,365 | 2,854,233 
             |     99.85       0.15 |    100.00 
-------------+----------------------+----------
       Total |15,582,168     22,936 |15,605,104 
             |     99.85       0.15 |    100.00 
24

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

     Smoking |          Non-haematological cancer
      status |     Never  Last year  2-5 years   5+ years |     Total
-------------+--------------------------------------------+----------
       Never | 7,164,550     26,441     81,483    202,577 | 7,475,051 
             |     95.85       0.35       1.09       2.71 |    100.00 
-------------+--------------------------------------------+----------
      Former | 4,883,970     36,017    107,283    248,550 | 5,275,820 
             |     92.57       0.68       2.03       4.71 |    100.00 
-------------+--------------------------------------------+----------
     Current | 2,778,065      9,907     22,413     43,848 | 2,854,233 
             |     97.33       0.35       0.79       1.54 |    100.00 
-------------+--------------------------------------------+----------
       Total |14,826,585     72,365    211,179    494,975 |15,605,104 
             |     95.01       0.46       1.35       3.17 |    100.00 
22

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

     Smoking |            Haematological cancer
      status |     Never  Last year  2-5 years   5+ years |     Total
-------------+--------------------------------------------+----------
       Never | 7,436,159      3,311     10,251     25,330 | 7,475,051 
             |     99.48       0.04       0.14       0.34 |    100.00 
-------------+--------------------------------------------+----------
      Former | 5,232,757      3,922     12,557     26,584 | 5,275,820 
             |     99.18       0.07       0.24       0.50 |    100.00 
-------------+--------------------------------------------+----------
     Current | 2,844,759        961      2,595      5,918 | 2,854,233 
             |     99.67       0.03       0.09       0.21 |    100.00 
-------------+--------------------------------------------+----------
       Total |15,513,675      8,194     25,403     57,832 |15,605,104 
             |     99.41       0.05       0.16       0.37 |    100.00 
34

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

     Smoking |     Reduced kidney function
      status |      None  Stage 3a/  Stage 4/5 |     Total
-------------+---------------------------------+----------
       Never | 7,080,137    368,839     26,075 | 7,475,051 
             |     94.72       4.93       0.35 |    100.00 
-------------+---------------------------------+----------
      Former | 4,741,969    492,521     41,330 | 5,275,820 
             |     89.88       9.34       0.78 |    100.00 
-------------+---------------------------------+----------
     Current | 2,783,454     65,069      5,710 | 2,854,233 
             |     97.52       2.28       0.20 |    100.00 
-------------+---------------------------------+----------
       Total |14,605,560    926,429     73,115 |15,605,104 
             |     93.59       5.94       0.47 |    100.00 
19

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

             |       Diagnosed
     Smoking |     hypertension
      status |         0          1 |     Total
-------------+----------------------+----------
       Never | 6,100,016  1,375,035 | 7,475,051 
             |     81.61      18.39 |    100.00 
-------------+----------------------+----------
      Former | 3,643,698  1,632,122 | 5,275,820 
             |     69.06      30.94 |    100.00 
-------------+----------------------+----------
     Current | 2,474,323    379,910 | 2,854,233 
             |     86.69      13.31 |    100.00 
-------------+----------------------+----------
       Total |12,218,037  3,387,067 |15,605,104 
             |     78.30      21.70 |    100.00 

. 
. 
. /* SENSE CHECK OUTCOMES=======================================================*/
. 
. safetab covid_death_itu covid_tpp_prob_or_susp  , row col
41

+-------------------+
| Key               |
|-------------------|
|     frequency     |
|  row percentage   |
| column percentage |
+-------------------+

Failure/ce |
   nsoring |
 indicator |
       for |   Failure/censoring
  outcome: |     indicator for
     covid |    outcome: covid
 death/ITU |    prob/susp. case
      adm. |         0          1 |     Total
-----------+----------------------+----------
         0 |15,629,924    645,262 |16,275,186 
           |     96.04       3.96 |    100.00 
           |     99.63      98.98 |     99.61 
-----------+----------------------+----------
         1 |    57,472      6,671 |    64,143 
           |     89.60      10.40 |    100.00 
           |      0.37       1.02 |      0.39 
-----------+----------------------+----------
     Total |15,687,396    651,933 |16,339,329 
           |     96.01       3.99 |    100.00 
           |    100.00     100.00 |    100.00 

. safetab covid_death_itu covid_tpp_prob  , row col
33

+-------------------+
| Key               |
|-------------------|
|     frequency     |
|  row percentage   |
| column percentage |
+-------------------+

Failure/ce |
   nsoring |
 indicator |
       for |   Failure/censoring
  outcome: |     indicator for
     covid |  outcome: covid prob
 death/ITU |         case
      adm. |         0          1 |     Total
-----------+----------------------+----------
         0 |16,231,305     43,881 |16,275,186 
           |     99.73       0.27 |    100.00 
           |     99.62      96.63 |     99.61 
-----------+----------------------+----------
         1 |    62,613      1,530 |    64,143 
           |     97.61       2.39 |    100.00 
           |      0.38       3.37 |      0.39 
-----------+----------------------+----------
     Total |16,293,918     45,411 |16,339,329 
           |     99.72       0.28 |    100.00 
           |    100.00     100.00 |    100.00 

. 
. 
. * Close log file 
. log close
      name:  <unnamed>
       log:  E:\alex\school-age-children-and-covid\analysis\log\02_an_data_checks.log
  log type:  text
 closed on:   9 Jul 2020, 12:54:04
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
