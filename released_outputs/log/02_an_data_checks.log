--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  E:\caroline\school-age-children-and-covid\analysis\log\02_an_data_checks.log
  log type:  text
 opened on:  14 Jul 2020, 23:35:51

. 
. * Open Stata dataset
. use $tempdir\analysis_dataset, clear

. 
. *run ssc install if not on local machine - server needs datacheck.ado file
. *ssc install datacheck 
. 
. *Duplicate patient check
. datacheck _n==1, by(patient_id) nol

. 
. 
. /* CHECK INCLUSION AND EXCLUSION CRITERIA=====================================*/ 
. 
. * DATA STRUCTURE: Confirm one row per patient 
. duplicates tag patient_id, generate(dup_check)

Duplicates in terms of patient_id

. assert dup_check == 0 

. drop dup_check

. 
. * INCLUSION 1: >=18 and <=110 at 1 March 2020 
. assert age < .

. assert age >= 18 

. assert age <= 110

.  
. * INCLUSION 2: M or F gender at 1 March 2020 
. assert inlist(sex, "M", "F")

. 
. * EXCLUDE 1:  MISSING IMD
. assert inlist(imd, 1, 2, 3, 4, 5)

. 
. * EXCLUDE 2:  HH with more than 10 people
. datacheck inlist(household_size, 1, 2, 3, 4, 5,6, 7, 8, 9, 10), nol

 (266108 contradictions)

. 
. /* EXPECTED VALUES============================================================*/ 
. 
. *HH
. datacheck kids_cat3<., nol

. datacheck inlist(kids_cat3, 0,1, 2), nol

. 
. datacheck number_kids<., nol

. datacheck inlist(number_kids, 0,1,2,3,4,5,6,7,8,9), nol

 (1694 contradictions)

. 
. * Age
. datacheck age<., nol

. datacheck inlist(agegroup, 1, 2, 3, 4, 5, 6), nol

 (1058053 contradictions)

. datacheck inlist(age66, 0, 1), nol

. 
. * Sex
. datacheck inlist(male, 0, 1), nol

. 
. * BMI 
. datacheck inlist(obese4cat, 1, 2, 3, 4), nol

. datacheck inlist(bmicat, 1, 2, 3, 4, 5, 6, .u), nol

. 
. * IMD
. datacheck inlist(imd, 1, 2, 3, 4, 5), nol

. 
. * Ethnicity
. datacheck inlist(ethnicity, 1, 2, 3, 4, 5, .u), nol

. 
. * Smoking
. datacheck inlist(smoke, 1, 2, 3, .u), nol

. datacheck inlist(smoke_nomiss, 1, 2, 3), nol 

. 
. 
. * Check date ranges for all comorbidities 
. 
. foreach var of varlist  chronic_respiratory_disease     ///
>                                         chronic_cardiac_disease         ///
>                                         diabetes                                                ///
>                                         chronic_liver_disease           ///
>                                         other_neuro                     ///
>                                         stroke_dementia ///
>                                         ra_sle_psoriasis                                ///
>                                         perm_immunodef  ///
>                                         temp_immunodef  ///
>                                         organ_trans                     /// 
>                                         asplenia                        /// 
>                                         hypertension                            ///
>                                         {
  2.                                                 
.         summ `var'_date, format
  3. 
. }

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
chronic_r~te |    668,456   10apr2009    6395.105  15dec1899  15jul2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
chronic_c~te |  1,107,121   12nov2006    6611.784  15jan1840  15sep2106

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
diabetes_d~e |  1,641,106   28dec2008     6542.43  15jan1860  15jul2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
chronic_l~te |     98,959   12sep2009    6349.967  15dec1840  15jul2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
other_neur~e |    163,722   07jan2002    8137.452  15jan1860  15jul2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
stroke_dem~e |    388,015   06aug2010    5502.224  15dec1899  15jul2096

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
ra_sle_pso~e |    816,225   12may2002    7366.192  15jan1840  15mar3000

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
perm_immun~e |     43,801   10jan2009    6188.668  15jan1900  15jan2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
temp_immun~e |      4,470   30aug2019    102.8131  15feb2019  15jan2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
organ_tran~e |     18,632   24jun2007    5577.123  15dec1899  15jul2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
asplenia_d~e |     23,155   26nov1992    9066.105  15dec1899  15jul2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
hypertensi~e |  3,397,578   05aug2004    7267.093  15jan1800  15feb2058

. 
. foreach comorb in $varlist { 
  2. 
.         local comorb: subinstr local comorb "i." ""
  3.         safetab `comorb', m
  4.         
. }

. 
. * Outcome dates
. summ  date_covid_death_itu  date_covid_tpp_prob_or_susp, format

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
date_covid~u |     64,252   31mar2020    33.06311  02feb2020  01jun2020
date_covid~p |    673,390   24apr2020    32.76973  15feb2020  15jul2020

. summ  date_covid_death_itu  date_covid_tpp_prob, format

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
date_covid~u |     64,252   31mar2020    33.06311  02feb2020  01jun2020
date_covid~b |     47,150   02may2020    29.69788  15feb2020  15jul2020

. 
. /* LOGICAL RELATIONSHIPS======================================================*/ 
. 
. *HH variables
. safetab kids_cat3 tot_people_hh
0

  Presence of |
  children or |
 young people |
       in the |             Number of people in household
    household |         1          2          3          4          5 |     Total
--------------+-------------------------------------------------------+----------
      No kids | 3,505,931  4,434,566  1,892,794    943,890    698,674 |11,475,855 
Kids under 12 |         0    226,325    800,784  1,101,936  1,487,282 | 3,616,327 
Kids under 18 |         0     95,822    330,455    453,755    368,620 | 1,248,652 
--------------+-------------------------------------------------------+----------
        Total | 3,505,931  4,756,713  3,024,033  2,499,581  2,554,576 |16,340,834 

. safetab number_kids tot_people_hh
0

**TABLE OF number_kids tot_people_hh REDACTED DUE TO SMALL N**


. safetab household_size tot_people_hh
0

    Number |
 people in |             Number of people in household
 household |         1          2          3          4          5 |     Total
-----------+-------------------------------------------------------+----------
         1 | 3,505,931          0          0          0          0 | 3,505,931 
         2 |         0  4,756,713          0          0          0 | 4,756,713 
         3 |         0          0  3,024,033          0          0 | 3,024,033 
         4 |         0          0          0  2,499,581          0 | 2,499,581 
         5 |         0          0          0          0  1,142,951 | 1,142,951 
         6 |         0          0          0          0    549,157 |   549,157 
         7 |         0          0          0          0    283,154 |   283,154 
         8 |         0          0          0          0    159,348 |   159,348 
         9 |         0          0          0          0     94,863 |    94,863 
        10 |         0          0          0          0     58,995 |    58,995 
        11 |         0          0          0          0     39,400 |    39,400 
        12 |         0          0          0          0     26,615 |    26,615 
        13 |         0          0          0          0     19,463 |    19,463 
        14 |         0          0          0          0     14,262 |    14,262 
        15 |         0          0          0          0     12,187 |    12,187 
        16 |         0          0          0          0      9,013 |     9,013 
        17 |         0          0          0          0      7,483 |     7,483 
        18 |         0          0          0          0      7,287 |     7,287 
        19 |         0          0          0          0      5,602 |     5,602 
        20 |         0          0          0          0      5,201 |     5,201 
        21 |         0          0          0          0      5,054 |     5,054 
        22 |         0          0          0          0      3,928 |     3,928 
        23 |         0          0          0          0      4,222 |     4,222 
        24 |         0          0          0          0      3,822 |     3,822 
        25 |         0          0          0          0      3,755 |     3,755 
        26 |         0          0          0          0      3,479 |     3,479 
        27 |         0          0          0          0      3,451 |     3,451 
        28 |         0          0          0          0      3,031 |     3,031 
        29 |         0          0          0          0      3,068 |     3,068 
        30 |         0          0          0          0      3,004 |     3,004 
        31 |         0          0          0          0      2,632 |     2,632 
        32 |         0          0          0          0      2,288 |     2,288 
        33 |         0          0          0          0      2,105 |     2,105 
        34 |         0          0          0          0      3,109 |     3,109 
        35 |         0          0          0          0      2,462 |     2,462 
        36 |         0          0          0          0      1,758 |     1,758 
        37 |         0          0          0          0      2,104 |     2,104 
        38 |         0          0          0          0      2,122 |     2,122 
        39 |         0          0          0          0      2,057 |     2,057 
        40 |         0          0          0          0      2,343 |     2,343 
        41 |         0          0          0          0      1,997 |     1,997 
        42 |         0          0          0          0      1,722 |     1,722 
        43 |         0          0          0          0      1,884 |     1,884 
        44 |         0          0          0          0      1,897 |     1,897 
        45 |         0          0          0          0      1,171 |     1,171 
        46 |         0          0          0          0      1,538 |     1,538 
        47 |         0          0          0          0      1,583 |     1,583 
        48 |         0          0          0          0      1,593 |     1,593 
        49 |         0          0          0          0      1,393 |     1,393 
        50 |         0          0          0          0      1,590 |     1,590 
        51 |         0          0          0          0      1,383 |     1,383 
        52 |         0          0          0          0      1,511 |     1,511 
        53 |         0          0          0          0        703 |       703 
        54 |         0          0          0          0        964 |       964 
        55 |         0          0          0          0      1,543 |     1,543 
        56 |         0          0          0          0        854 |       854 
        57 |         0          0          0          0        655 |       655 
        58 |         0          0          0          0      1,153 |     1,153 
        59 |         0          0          0          0        943 |       943 
        60 |         0          0          0          0      1,194 |     1,194 
        61 |         0          0          0          0      1,033 |     1,033 
        62 |         0          0          0          0        823 |       823 
        63 |         0          0          0          0      1,015 |     1,015 
        64 |         0          0          0          0        732 |       732 
        65 |         0          0          0          0        990 |       990 
        66 |         0          0          0          0        824 |       824 
        67 |         0          0          0          0        852 |       852 
        68 |         0          0          0          0        292 |       292 
        69 |         0          0          0          0      1,032 |     1,032 
        70 |         0          0          0          0        469 |       469 
        71 |         0          0          0          0        544 |       544 
        72 |         0          0          0          0        448 |       448 
        73 |         0          0          0          0        386 |       386 
        74 |         0          0          0          0        896 |       896 
        75 |         0          0          0          0        299 |       299 
        76 |         0          0          0          0        454 |       454 
        77 |         0          0          0          0        477 |       477 
        78 |         0          0          0          0        342 |       342 
        79 |         0          0          0          0        209 |       209 
        80 |         0          0          0          0        320 |       320 
        81 |         0          0          0          0        161 |       161 
        82 |         0          0          0          0        285 |       285 
        83 |         0          0          0          0        332 |       332 
        84 |         0          0          0          0        194 |       194 
        85 |         0          0          0          0        249 |       249 
        86 |         0          0          0          0          6 |         6 
        87 |         0          0          0          0        360 |       360 
        88 |         0          0          0          0         88 |        88 
        89 |         0          0          0          0         89 |        89 
        90 |         0          0          0          0        270 |       270 
        91 |         0          0          0          0        314 |       314 
        92 |         0          0          0          0         92 |        92 
        93 |         0          0          0          0        465 |       465 
        94 |         0          0          0          0        278 |       278 
        95 |         0          0          0          0        295 |       295 
        96 |         0          0          0          0        106 |       106 
        97 |         0          0          0          0         26 |        26 
        98 |         0          0          0          0        212 |       212 
        99 |         0          0          0          0        197 |       197 
       100 |         0          0          0          0         30 |        30 
       102 |         0          0          0          0        102 |       102 
       103 |         0          0          0          0        103 |       103 
       104 |         0          0          0          0         83 |        83 
       106 |         0          0          0          0        105 |       105 
       108 |         0          0          0          0        126 |       126 
       114 |         0          0          0          0        114 |       114 
       117 |         0          0          0          0        166 |       166 
       119 |         0          0          0          0        156 |       156 
       120 |         0          0          0          0         18 |        18 
       125 |         0          0          0          0         17 |        17 
       128 |         0          0          0          0        253 |       253 
       129 |         0          0          0          0         58 |        58 
       130 |         0          0          0          0         46 |        46 
       131 |         0          0          0          0        119 |       119 
       132 |         0          0          0          0        132 |       132 
       133 |         0          0          0          0        208 |       208 
       134 |         0          0          0          0        401 |       401 
       138 |         0          0          0          0        138 |       138 
       139 |         0          0          0          0        133 |       133 
       144 |         0          0          0          0         31 |        31 
       145 |         0          0          0          0         16 |        16 
       147 |         0          0          0          0        147 |       147 
       149 |         0          0          0          0        149 |       149 
       152 |         0          0          0          0        152 |       152 
       154 |         0          0          0          0        189 |       189 
       157 |         0          0          0          0        157 |       157 
       159 |         0          0          0          0         39 |        39 
       160 |         0          0          0          0        160 |       160 
       163 |         0          0          0          0        163 |       163 
       170 |         0          0          0          0         39 |        39 
       177 |         0          0          0          0        177 |       177 
       180 |         0          0          0          0         31 |        31 
       182 |         0          0          0          0        214 |       214 
       184 |         0          0          0          0        183 |       183 
       185 |         0          0          0          0         23 |        23 
       186 |         0          0          0          0        129 |       129 
       194 |         0          0          0          0        194 |       194 
       195 |         0          0          0          0        197 |       197 
       199 |         0          0          0          0         55 |        55 
       204 |         0          0          0          0         61 |        61 
       205 |         0          0          0          0        205 |       205 
       222 |         0          0          0          0        104 |       104 
       229 |         0          0          0          0         64 |        64 
       238 |         0          0          0          0        237 |       237 
       248 |         0          0          0          0        245 |       245 
       249 |         0          0          0          0         91 |        91 
       255 |         0          0          0          0         57 |        57 
       258 |         0          0          0          0        255 |       255 
       260 |         0          0          0          0        131 |       131 
       264 |         0          0          0          0         76 |        76 
       279 |         0          0          0          0         91 |        91 
       386 |         0          0          0          0        102 |       102 
       392 |         0          0          0          0         71 |        71 
       393 |         0          0          0          0        393 |       393 
       406 |         0          0          0          0         40 |        40 
       423 |         0          0          0          0        423 |       423 
       427 |         0          0          0          0         59 |        59 
       453 |         0          0          0          0         59 |        59 
       458 |         0          0          0          0        458 |       458 
       463 |         0          0          0          0        462 |       462 
       478 |         0          0          0          0         49 |        49 
       486 |         0          0          0          0        485 |       485 
       507 |         0          0          0          0        102 |       102 
       604 |         0          0          0          0        601 |       601 
       637 |         0          0          0          0        634 |       634 
       640 |         0          0          0          0        640 |       640 
       656 |         0          0          0          0         96 |        96 
       732 |         0          0          0          0        135 |       135 
       855 |         0          0          0          0        855 |       855 
       878 |         0          0          0          0        878 |       878 
       896 |         0          0          0          0        894 |       894 
      1012 |         0          0          0          0      1,009 |     1,009 
      1065 |         0          0          0          0      1,059 |     1,059 
-----------+-------------------------------------------------------+----------
     Total | 3,505,931  4,756,713  3,024,033  2,499,581  2,554,576 |16,340,834 

. 
. * BMI
. bysort bmicat: summ bmi

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> bmicat = Underweight (<18.5)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         bmi |    311,277    17.42251    .8306896         15       18.4

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> bmicat = Normal (18.5-24.9)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         bmi |  4,666,243    22.34551    1.716538       18.5       24.9

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> bmicat = Overweight (25-29.9)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         bmi |  4,421,741    27.26779    1.413674         25       29.9

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> bmicat = Obese I (30-34.9)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         bmi |  2,230,841    32.08332    1.416689         30       34.9

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> bmicat = Obese II (35-39.9)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         bmi |    863,897    37.05061    1.406931         35       39.9

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> bmicat = Obese III (40+)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         bmi |    435,638     43.3926    2.640639         40         50

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> bmicat = Unknown (.u)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         bmi |          0


. safetab bmicat obese4cat, m
17

                     |     Evidence of obesity (4 categories)
         Grouped BMI | No record  Obese I (  Obese II   Obese III |     Total
---------------------+--------------------------------------------+----------
 Underweight (<18.5) |   311,277          0          0          0 |   311,277 
  Normal (18.5-24.9) | 4,666,243          0          0          0 | 4,666,243 
Overweight (25-29.9) | 4,421,741          0          0          0 | 4,421,741 
   Obese I (30-34.9) |         0  2,230,841          0          0 | 2,230,841 
  Obese II (35-39.9) |         0          0    863,897          0 |   863,897 
     Obese III (40+) |         0          0          0    435,638 |   435,638 
        Unknown (.u) | 3,411,197          0          0          0 | 3,411,197 
---------------------+--------------------------------------------+----------
               Total |12,810,458  2,230,841    863,897    435,638 |16,340,834 

. 
. * Age
. bysort agegroup: summ age

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> agegroup = 18-<30

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |  3,113,091    23.87005    3.423567         18         29

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> agegroup = 30-<40

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |  2,947,941    34.42874    2.869586         30         39

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> agegroup = 40-<50

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |  2,596,167     44.5338     2.92655         40         49

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> agegroup = 50-<60

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |  2,696,558    54.43745    2.846807         50         59

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> agegroup = 60-<70

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |  2,163,285    64.31411    2.883636         60         69

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> agegroup = 70-<80

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |  1,765,739    73.95755      2.7598         70         79

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> agegroup = 80+

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |  1,058,053    85.40143    4.477504         80        110


. safetab agegroup age66, m
15

   Grouped |  66 years and older
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<30 | 3,113,091          0 | 3,113,091 
    30-<40 | 2,947,941          0 | 2,947,941 
    40-<50 | 2,596,167          0 | 2,596,167 
    50-<60 | 2,696,558          0 | 2,696,558 
    60-<70 | 1,560,287    602,998 | 2,163,285 
    70-<80 |         0  1,765,739 | 1,765,739 
       80+ |         0  1,058,053 | 1,058,053 
-----------+----------------------+----------
     Total |12,914,044  3,426,790 |16,340,834 

. 
. * Smoking
. safetab smoke smoke_nomiss, m
19

             |  Smoking status (missing set to
     Smoking |               non)
      status |     Never     Former    Current |     Total
-------------+---------------------------------+----------
       Never | 7,474,961          0          0 | 7,474,961 
      Former |         0  5,276,611          0 | 5,276,611 
     Current |         0          0  2,853,987 | 2,853,987 
Unknown (.u) |   735,275          0          0 |   735,275 
-------------+---------------------------------+----------
       Total | 8,210,236  5,276,611  2,853,987 |16,340,834 

. 
. * Diabetes
. *safetab diabcat diabetes, m
. 
. * CKD
. safetab reduced egfr_cat, m
17

       Reduced kidney |                          Calculated eGFR
             function |         0         15         30         45         60          . |     Total
----------------------+------------------------------------------------------------------+----------
                 None |         0          0          0          0 10,988,240  4,350,641 |15,338,881 
Stage 3a/3b egfr 30-6 |         0          0    238,572    690,029          0          0 |   928,601 
    Stage 4/5 egfr<30 |    13,917     59,435          0          0          0          0 |    73,352 
----------------------+------------------------------------------------------------------+----------
                Total |    13,917     59,435    238,572    690,029 10,988,240  4,350,641 |16,340,834 

. 
. 
. /* EXPECTED RELATIONSHIPS=====================================================*/ 
. 
. /*  Relationships between demographic/lifestyle variables  */
. safetab agegroup bmicat,        row 
16

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

   Grouped |                            Grouped BMI
       age | Underweig  Normal (1  Overweigh  Obese I (  Obese II   Obese III |     Total
-----------+------------------------------------------------------------------+----------
    18-<30 |   119,452  1,012,362    452,904    200,336     90,273     53,121 | 1,928,448 
           |      6.19      52.50      23.49      10.39       4.68       2.75 |    100.00 
-----------+------------------------------------------------------------------+----------
    30-<40 |    56,706    954,105    677,593    306,338    128,769     74,823 | 2,198,334 
           |      2.58      43.40      30.82      13.94       5.86       3.40 |    100.00 
-----------+------------------------------------------------------------------+----------
    40-<50 |    28,397    702,243    729,122    367,571    147,747     80,639 | 2,055,719 
           |      1.38      34.16      35.47      17.88       7.19       3.92 |    100.00 
-----------+------------------------------------------------------------------+----------
    50-<60 |    23,154    632,614    838,885    475,848    192,381     99,792 | 2,262,674 
           |      1.02      27.96      37.07      21.03       8.50       4.41 |    100.00 
-----------+------------------------------------------------------------------+----------
    60-<70 |    23,161    524,964    725,684    407,707    156,010     73,045 | 1,910,571 
           |      1.21      27.48      37.98      21.34       8.17       3.82 |    100.00 
-----------+------------------------------------------------------------------+----------
    70-<80 |    25,187    475,244    641,762    326,886    109,433     42,872 | 1,621,384 
           |      1.55      29.31      39.58      20.16       6.75       2.64 |    100.00 
-----------+------------------------------------------------------------------+----------
       80+ |    35,220    364,711    355,791    146,155     39,284     11,346 |   952,507 
           |      3.70      38.29      37.35      15.34       4.12       1.19 |    100.00 
-----------+------------------------------------------------------------------+----------
     Total |   311,277  4,666,243  4,421,741  2,230,841    863,897    435,638 |12,929,637 
           |      2.41      36.09      34.20      17.25       6.68       3.37 |    100.00 

. safetab agegroup smoke,         row  
15

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

   Grouped |          Smoking status
       age |     Never     Former    Current |     Total
-----------+---------------------------------+----------
    18-<30 | 1,689,675    387,603    590,978 | 2,668,256 
           |     63.33      14.53      22.15 |    100.00 
-----------+---------------------------------+----------
    30-<40 | 1,383,722    749,249    689,150 | 2,822,121 
           |     49.03      26.55      24.42 |    100.00 
-----------+---------------------------------+----------
    40-<50 | 1,145,214    824,375    557,287 | 2,526,876 
           |     45.32      32.62      22.05 |    100.00 
-----------+---------------------------------+----------
    50-<60 | 1,213,502    919,800    515,693 | 2,648,995 
           |     45.81      34.72      19.47 |    100.00 
-----------+---------------------------------+----------
    60-<70 |   921,120    911,489    303,798 | 2,136,407 
           |     43.12      42.66      14.22 |    100.00 
-----------+---------------------------------+----------
    70-<80 |   672,623    926,333    154,091 | 1,753,047 
           |     38.37      52.84       8.79 |    100.00 
-----------+---------------------------------+----------
       80+ |   449,105    557,762     42,990 | 1,049,857 
           |     42.78      53.13       4.09 |    100.00 
-----------+---------------------------------+----------
     Total | 7,474,961  5,276,611  2,853,987 |15,605,559 
           |     47.90      33.81      18.29 |    100.00 

. safetab agegroup ethnicity, row 
19

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

   Grouped |                       Ethnicity
       age |     White      Mixed  Asian or       Black      Other |     Total
-----------+-------------------------------------------------------+----------
    18-<30 | 1,694,109     57,927    221,878     82,547    109,250 | 2,165,711 
           |     78.22       2.67      10.25       3.81       5.04 |    100.00 
-----------+-------------------------------------------------------+----------
    30-<40 | 1,834,519     49,243    296,442     82,457     93,359 | 2,356,020 
           |     77.87       2.09      12.58       3.50       3.96 |    100.00 
-----------+-------------------------------------------------------+----------
    40-<50 | 1,661,928     34,952    229,339     83,432     68,868 | 2,078,519 
           |     79.96       1.68      11.03       4.01       3.31 |    100.00 
-----------+-------------------------------------------------------+----------
    50-<60 | 1,819,605     23,428    126,429     65,661     39,040 | 2,074,163 
           |     87.73       1.13       6.10       3.17       1.88 |    100.00 
-----------+-------------------------------------------------------+----------
    60-<70 | 1,506,205     10,410     87,202     27,267     21,667 | 1,652,751 
           |     91.13       0.63       5.28       1.65       1.31 |    100.00 
-----------+-------------------------------------------------------+----------
    70-<80 | 1,261,532      4,732     41,972     12,226     10,460 | 1,330,922 
           |     94.79       0.36       3.15       0.92       0.79 |    100.00 
-----------+-------------------------------------------------------+----------
       80+ |   690,215      2,447     22,961      9,079      4,778 |   729,480 
           |     94.62       0.34       3.15       1.24       0.65 |    100.00 
-----------+-------------------------------------------------------+----------
     Total |10,468,113    183,139  1,026,223    362,669    347,422 |12,387,566 
           |     84.51       1.48       8.28       2.93       2.80 |    100.00 

. safetab agegroup imd,           row 
13

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

   Grouped |          Index of Multiple Deprivation (IMD)
       age | 1 least d          2          3          4  5 most de |     Total
-----------+-------------------------------------------------------+----------
    18-<30 |   526,034    573,082    646,558    699,913    667,504 | 3,113,091 
           |     16.90      18.41      20.77      22.48      21.44 |    100.00 
-----------+-------------------------------------------------------+----------
    30-<40 |   500,786    552,774    613,044    666,429    614,908 | 2,947,941 
           |     16.99      18.75      20.80      22.61      20.86 |    100.00 
-----------+-------------------------------------------------------+----------
    40-<50 |   549,397    525,091    527,653    525,362    468,664 | 2,596,167 
           |     21.16      20.23      20.32      20.24      18.05 |    100.00 
-----------+-------------------------------------------------------+----------
    50-<60 |   608,505    579,968    558,710    517,581    431,794 | 2,696,558 
           |     22.57      21.51      20.72      19.19      16.01 |    100.00 
-----------+-------------------------------------------------------+----------
    60-<70 |   517,315    486,961    459,667    394,155    305,187 | 2,163,285 
           |     23.91      22.51      21.25      18.22      14.11 |    100.00 
-----------+-------------------------------------------------------+----------
    70-<80 |   465,544    420,101    378,709    296,136    205,249 | 1,765,739 
           |     26.37      23.79      21.45      16.77      11.62 |    100.00 
-----------+-------------------------------------------------------+----------
       80+ |   278,142    249,676    225,834    178,344    126,057 | 1,058,053 
           |     26.29      23.60      21.34      16.86      11.91 |    100.00 
-----------+-------------------------------------------------------+----------
     Total | 3,445,723  3,387,653  3,410,175  3,277,920  2,819,363 |16,340,834 
           |     21.09      20.73      20.87      20.06      17.25 |    100.00 

. safetab agegroup shield,    row 
16

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

   Grouped |  Probable shielding
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<30 | 2,499,460    613,631 | 3,113,091 
           |     80.29      19.71 |    100.00 
-----------+----------------------+----------
    30-<40 | 2,389,444    558,497 | 2,947,941 
           |     81.05      18.95 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,107,134    489,033 | 2,596,167 
           |     81.16      18.84 |    100.00 
-----------+----------------------+----------
    50-<60 | 2,123,167    573,391 | 2,696,558 
           |     78.74      21.26 |    100.00 
-----------+----------------------+----------
    60-<70 | 1,588,151    575,134 | 2,163,285 
           |     73.41      26.59 |    100.00 
-----------+----------------------+----------
    70-<80 | 1,159,112    606,627 | 1,765,739 
           |     65.64      34.36 |    100.00 
-----------+----------------------+----------
       80+ |   657,197    400,856 | 1,058,053 
           |     62.11      37.89 |    100.00 
-----------+----------------------+----------
     Total |12,523,665  3,817,169 |16,340,834 
           |     76.64      23.36 |    100.00 

. 
. safetab bmicat smoke,            row   
13

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

                     |          Smoking status
         Grouped BMI |     Never     Former    Current |     Total
---------------------+---------------------------------+----------
 Underweight (<18.5) |   149,770     68,696     84,846 |   303,312 
                     |     49.38      22.65      27.97 |    100.00 
---------------------+---------------------------------+----------
  Normal (18.5-24.9) | 2,296,907  1,420,148    898,694 | 4,615,749 
                     |     49.76      30.77      19.47 |    100.00 
---------------------+---------------------------------+----------
Overweight (25-29.9) | 1,991,796  1,708,655    694,026 | 4,394,477 
                     |     45.32      38.88      15.79 |    100.00 
---------------------+---------------------------------+----------
   Obese I (30-34.9) |   951,411    926,386    341,283 | 2,219,080 
                     |     42.87      41.75      15.38 |    100.00 
---------------------+---------------------------------+----------
  Obese II (35-39.9) |   366,426    358,977    133,882 |   859,285 
                     |     42.64      41.78      15.58 |    100.00 
---------------------+---------------------------------+----------
     Obese III (40+) |   186,045    179,059     68,001 |   433,105 
                     |     42.96      41.34      15.70 |    100.00 
---------------------+---------------------------------+----------
               Total | 5,942,355  4,661,921  2,220,732 |12,825,008 
                     |     46.33      36.35      17.32 |    100.00 

. safetab bmicat ethnicity,        row 
17

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

                     |                       Ethnicity
         Grouped BMI |     White      Mixed  Asian or       Black      Other |     Total
---------------------+-------------------------------------------------------+----------
 Underweight (<18.5) |   194,676      4,406     27,587      5,649     13,965 |   246,283 
                     |     79.05       1.79      11.20       2.29       5.67 |    100.00 
---------------------+-------------------------------------------------------+----------
  Normal (18.5-24.9) | 3,236,000     59,884    324,044     89,779    134,132 | 3,843,839 
                     |     84.19       1.56       8.43       2.34       3.49 |    100.00 
---------------------+-------------------------------------------------------+----------
Overweight (25-29.9) | 3,076,082     46,052    306,983    103,126     77,377 | 3,609,620 
                     |     85.22       1.28       8.50       2.86       2.14 |    100.00 
---------------------+-------------------------------------------------------+----------
   Obese I (30-34.9) | 1,550,574     21,971    125,397     57,709     29,333 | 1,784,984 
                     |     86.87       1.23       7.03       3.23       1.64 |    100.00 
---------------------+-------------------------------------------------------+----------
  Obese II (35-39.9) |   603,276      8,317     37,924     22,427      8,975 |   680,919 
                     |     88.60       1.22       5.57       3.29       1.32 |    100.00 
---------------------+-------------------------------------------------------+----------
     Obese III (40+) |   306,159      4,324     14,618     10,740      3,782 |   339,623 
                     |     90.15       1.27       4.30       3.16       1.11 |    100.00 
---------------------+-------------------------------------------------------+----------
               Total | 8,966,767    144,954    836,553    289,430    267,564 |10,505,268 
                     |     85.35       1.38       7.96       2.76       2.55 |    100.00 

. safetab bmicat imd,              row 
11

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

                     |          Index of Multiple Deprivation (IMD)
         Grouped BMI | 1 least d          2          3          4  5 most de |     Total
---------------------+-------------------------------------------------------+----------
 Underweight (<18.5) |    55,900     59,715     64,582     67,245     63,835 |   311,277 
                     |     17.96      19.18      20.75      21.60      20.51 |    100.00 
---------------------+-------------------------------------------------------+----------
  Normal (18.5-24.9) | 1,069,394  1,016,531    981,631    892,472    706,215 | 4,666,243 
                     |     22.92      21.78      21.04      19.13      15.13 |    100.00 
---------------------+-------------------------------------------------------+----------
Overweight (25-29.9) |   993,782    948,490    929,483    858,795    691,191 | 4,421,741 
                     |     22.47      21.45      21.02      19.42      15.63 |    100.00 
---------------------+-------------------------------------------------------+----------
   Obese I (30-34.9) |   434,492    448,503    467,239    467,058    413,549 | 2,230,841 
                     |     19.48      20.10      20.94      20.94      18.54 |    100.00 
---------------------+-------------------------------------------------------+----------
  Obese II (35-39.9) |   145,244    161,822    178,439    192,312    186,080 |   863,897 
                     |     16.81      18.73      20.66      22.26      21.54 |    100.00 
---------------------+-------------------------------------------------------+----------
     Obese III (40+) |    63,016     75,057     87,965    102,142    107,458 |   435,638 
                     |     14.47      17.23      20.19      23.45      24.67 |    100.00 
---------------------+-------------------------------------------------------+----------
               Total | 2,761,828  2,710,118  2,709,339  2,580,024  2,168,328 |12,929,637 
                     |     21.36      20.96      20.95      19.95      16.77 |    100.00 

. safetab bmicat hypertension, row 
20

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

                     |       Diagnosed
                     |     hypertension
         Grouped BMI |         0          1 |     Total
---------------------+----------------------+----------
 Underweight (<18.5) |   271,279     39,998 |   311,277 
                     |     87.15      12.85 |    100.00 
---------------------+----------------------+----------
  Normal (18.5-24.9) | 3,960,969    705,274 | 4,666,243 
                     |     84.89      15.11 |    100.00 
---------------------+----------------------+----------
Overweight (25-29.9) | 3,265,530  1,156,211 | 4,421,741 
                     |     73.85      26.15 |    100.00 
---------------------+----------------------+----------
   Obese I (30-34.9) | 1,464,692    766,149 | 2,230,841 
                     |     65.66      34.34 |    100.00 
---------------------+----------------------+----------
  Obese II (35-39.9) |   536,323    327,574 |   863,897 
                     |     62.08      37.92 |    100.00 
---------------------+----------------------+----------
     Obese III (40+) |   264,908    170,730 |   435,638 
                     |     60.81      39.19 |    100.00 
---------------------+----------------------+----------
               Total | 9,763,701  3,165,936 |12,929,637 
                     |     75.51      24.49 |    100.00 

. safetab bmicat shield,    row 
14

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

                     |  Probable shielding
         Grouped BMI |         0          1 |     Total
---------------------+----------------------+----------
 Underweight (<18.5) |   230,046     81,231 |   311,277 
                     |     73.90      26.10 |    100.00 
---------------------+----------------------+----------
  Normal (18.5-24.9) | 3,579,907  1,086,336 | 4,666,243 
                     |     76.72      23.28 |    100.00 
---------------------+----------------------+----------
Overweight (25-29.9) | 3,303,061  1,118,680 | 4,421,741 
                     |     74.70      25.30 |    100.00 
---------------------+----------------------+----------
   Obese I (30-34.9) | 1,610,457    620,384 | 2,230,841 
                     |     72.19      27.81 |    100.00 
---------------------+----------------------+----------
  Obese II (35-39.9) |   599,428    264,469 |   863,897 
                     |     69.39      30.61 |    100.00 
---------------------+----------------------+----------
     Obese III (40+) |   290,017    145,621 |   435,638 
                     |     66.57      33.43 |    100.00 
---------------------+----------------------+----------
               Total | 9,612,916  3,316,721 |12,929,637 
                     |     74.35      25.65 |    100.00 

. 
.                             
. safetab smoke ethnicity,        row 
16

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

     Smoking |                       Ethnicity
      status |     White      Mixed  Asian or       Black      Other |     Total
-------------+-------------------------------------------------------+----------
       Never | 4,479,319     95,422    711,962    233,976    205,665 | 5,726,344 
             |     78.22       1.67      12.43       4.09       3.59 |    100.00 
-------------+-------------------------------------------------------+----------
      Former | 3,815,815     41,553    153,763     64,809     60,637 | 4,136,577 
             |     92.25       1.00       3.72       1.57       1.47 |    100.00 
-------------+-------------------------------------------------------+----------
     Current | 1,948,449     37,355    113,040     47,187     57,787 | 2,203,818 
             |     88.41       1.70       5.13       2.14       2.62 |    100.00 
-------------+-------------------------------------------------------+----------
       Total |10,243,583    174,330    978,765    345,972    324,089 |12,066,739 
             |     84.89       1.44       8.11       2.87       2.69 |    100.00 

. safetab smoke imd,                      row 
10

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

     Smoking |          Index of Multiple Deprivation (IMD)
      status | 1 least d          2          3          4  5 most de |     Total
-------------+-------------------------------------------------------+----------
       Never | 1,780,566  1,639,957  1,565,485  1,421,688  1,067,265 | 7,474,961 
             |     23.82      21.94      20.94      19.02      14.28 |    100.00 
-------------+-------------------------------------------------------+----------
      Former | 1,201,272  1,169,989  1,133,276    997,956    774,118 | 5,276,611 
             |     22.77      22.17      21.48      18.91      14.67 |    100.00 
-------------+-------------------------------------------------------+----------
     Current |   343,887    448,859    568,712    702,478    790,051 | 2,853,987 
             |     12.05      15.73      19.93      24.61      27.68 |    100.00 
-------------+-------------------------------------------------------+----------
       Total | 3,325,725  3,258,805  3,267,473  3,122,122  2,631,434 |15,605,559 
             |     21.31      20.88      20.94      20.01      16.86 |    100.00 

. safetab smoke hypertension, row 
19

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

             |       Diagnosed
     Smoking |     hypertension
      status |         0          1 |     Total
-------------+----------------------+----------
       Never | 6,099,224  1,375,737 | 7,474,961 
             |     81.60      18.40 |    100.00 
-------------+----------------------+----------
      Former | 3,643,568  1,633,043 | 5,276,611 
             |     69.05      30.95 |    100.00 
-------------+----------------------+----------
     Current | 2,473,854    380,133 | 2,853,987 
             |     86.68      13.32 |    100.00 
-------------+----------------------+----------
       Total |12,216,646  3,388,913 |15,605,559 
             |     78.28      21.72 |    100.00 

. safetab smoke shield,    row 
13

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

     Smoking |  Probable shielding
      status |         0          1 |     Total
-------------+----------------------+----------
       Never | 5,925,498  1,549,463 | 7,474,961 
             |     79.27      20.73 |    100.00 
-------------+----------------------+----------
      Former | 3,736,854  1,539,757 | 5,276,611 
             |     70.82      29.18 |    100.00 
-------------+----------------------+----------
     Current | 2,166,211    687,776 | 2,853,987 
             |     75.90      24.10 |    100.00 
-------------+----------------------+----------
       Total |11,828,563  3,776,996 |15,605,559 
             |     75.80      24.20 |    100.00 

.                       
. safetab ethnicity imd,          row 
14

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

                      |          Index of Multiple Deprivation (IMD)
            Ethnicity | 1 least d          2          3          4  5 most de |     Total
----------------------+-------------------------------------------------------+----------
                White | 2,320,201  2,274,354  2,192,057  2,007,276  1,674,225 |10,468,113 
                      |     22.16      21.73      20.94      19.18      15.99 |    100.00 
----------------------+-------------------------------------------------------+----------
                Mixed |    25,115     30,638     36,966     43,819     46,601 |   183,139 
                      |     13.71      16.73      20.18      23.93      25.45 |    100.00 
----------------------+-------------------------------------------------------+----------
Asian or Asian Britis |    94,790    126,309    212,647    303,402    289,075 | 1,026,223 
                      |      9.24      12.31      20.72      29.56      28.17 |    100.00 
----------------------+-------------------------------------------------------+----------
                Black |    26,174     39,974     64,647    100,427    131,447 |   362,669 
                      |      7.22      11.02      17.83      27.69      36.24 |    100.00 
----------------------+-------------------------------------------------------+----------
                Other |    47,066     60,832     73,386     85,716     80,422 |   347,422 
                      |     13.55      17.51      21.12      24.67      23.15 |    100.00 
----------------------+-------------------------------------------------------+----------
                Total | 2,513,346  2,532,107  2,579,703  2,540,640  2,221,770 |12,387,566 
                      |     20.29      20.44      20.82      20.51      17.94 |    100.00 

. safetab shield imd,             row 
11

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

  Probable |          Index of Multiple Deprivation (IMD)
 shielding | 1 least d          2          3          4  5 most de |     Total
-----------+-------------------------------------------------------+----------
         0 | 2,620,401  2,587,371  2,619,617  2,532,952  2,163,324 |12,523,665 
           |     20.92      20.66      20.92      20.23      17.27 |    100.00 
-----------+-------------------------------------------------------+----------
         1 |   825,322    800,282    790,558    744,968    656,039 | 3,817,169 
           |     21.62      20.97      20.71      19.52      17.19 |    100.00 
-----------+-------------------------------------------------------+----------
     Total | 3,445,723  3,387,653  3,410,175  3,277,920  2,819,363 |16,340,834 
           |     21.09      20.73      20.87      20.06      17.25 |    100.00 

. 
. safetab shield ethnicity,               row 
17

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

  Probable |                       Ethnicity
 shielding |     White      Mixed  Asian or       Black      Other |     Total
-----------+-------------------------------------------------------+----------
         0 | 7,806,986    148,355    876,778    303,095    314,129 | 9,449,343 
           |     82.62       1.57       9.28       3.21       3.32 |    100.00 
-----------+-------------------------------------------------------+----------
         1 | 2,661,127     34,784    149,445     59,574     33,293 | 2,938,223 
           |     90.57       1.18       5.09       2.03       1.13 |    100.00 
-----------+-------------------------------------------------------+----------
     Total |10,468,113    183,139  1,026,223    362,669    347,422 |12,387,566 
           |     84.51       1.48       8.28       2.93       2.80 |    100.00 

. 
. 
. 
. * Relationships with age
. foreach var of varlist  asthma                                          ///
>                                         chronic_respiratory_disease     ///
>                                         chronic_cardiac_disease         ///
>                                         diabetes                                                ///
>                                         chronic_liver_disease           ///
>                                         other_neuro                     ///
>                                         stroke_dementia ///
>                                         ra_sle_psoriasis                                ///
>                                         other_immuno                            ///
>                                         organ_trans                     /// 
>                                         asplenia                        /// 
>                                         cancer_exhaem_cat                                               ///
>                                         cancer_haem_cat                                                 ///
>                                         reduced_kidney_function_cat ///
>                                         hypertension            ///             
>                                                                                 {
  2. 
.                 
.         safetab agegroup `var', row 
  3.  }
16

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

   Grouped |    Asthma category
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<30 | 2,520,018    593,073 | 3,113,091 
           |     80.95      19.05 |    100.00 
-----------+----------------------+----------
    30-<40 | 2,426,356    521,585 | 2,947,941 
           |     82.31      17.69 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,179,807    416,360 | 2,596,167 
           |     83.96      16.04 |    100.00 
-----------+----------------------+----------
    50-<60 | 2,294,596    401,962 | 2,696,558 
           |     85.09      14.91 |    100.00 
-----------+----------------------+----------
    60-<70 | 1,866,650    296,635 | 2,163,285 
           |     86.29      13.71 |    100.00 
-----------+----------------------+----------
    70-<80 | 1,537,419    228,320 | 1,765,739 
           |     87.07      12.93 |    100.00 
-----------+----------------------+----------
       80+ |   927,527    130,526 | 1,058,053 
           |     87.66      12.34 |    100.00 
-----------+----------------------+----------
     Total |13,752,373  2,588,461 |16,340,834 
           |     84.16      15.84 |    100.00 
37

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |  Chronic Respiratory
   Grouped |       Diseases
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<30 | 3,103,729      9,362 | 3,113,091 
           |     99.70       0.30 |    100.00 
-----------+----------------------+----------
    30-<40 | 2,934,881     13,060 | 2,947,941 
           |     99.56       0.44 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,563,232     32,935 | 2,596,167 
           |     98.73       1.27 |    100.00 
-----------+----------------------+----------
    50-<60 | 2,603,397     93,161 | 2,696,558 
           |     96.55       3.45 |    100.00 
-----------+----------------------+----------
    60-<70 | 2,000,778    162,507 | 2,163,285 
           |     92.49       7.51 |    100.00 
-----------+----------------------+----------
    70-<80 | 1,551,481    214,258 | 1,765,739 
           |     87.87      12.13 |    100.00 
-----------+----------------------+----------
       80+ |   914,880    143,173 | 1,058,053 
           |     86.47      13.53 |    100.00 
-----------+----------------------+----------
     Total |15,672,378    668,456 |16,340,834 
           |     95.91       4.09 |    100.00 
33

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |    Chronic Cardiac
   Grouped |       Diseases
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<30 | 3,092,799     20,292 | 3,113,091 
           |     99.35       0.65 |    100.00 
-----------+----------------------+----------
    30-<40 | 2,926,455     21,486 | 2,947,941 
           |     99.27       0.73 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,551,048     45,119 | 2,596,167 
           |     98.26       1.74 |    100.00 
-----------+----------------------+----------
    50-<60 | 2,565,865    130,693 | 2,696,558 
           |     95.15       4.85 |    100.00 
-----------+----------------------+----------
    60-<70 | 1,935,486    227,799 | 2,163,285 
           |     89.47      10.53 |    100.00 
-----------+----------------------+----------
    70-<80 | 1,434,171    331,568 | 1,765,739 
           |     81.22      18.78 |    100.00 
-----------+----------------------+----------
       80+ |   727,889    330,164 | 1,058,053 
           |     68.80      31.20 |    100.00 
-----------+----------------------+----------
     Total |15,233,713  1,107,121 |16,340,834 
           |     93.22       6.78 |    100.00 
18

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

   Grouped |       Diabetes
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<30 | 3,077,712     35,379 | 3,113,091 
           |     98.86       1.14 |    100.00 
-----------+----------------------+----------
    30-<40 | 2,873,142     74,799 | 2,947,941 
           |     97.46       2.54 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,434,794    161,373 | 2,596,167 
           |     93.78       6.22 |    100.00 
-----------+----------------------+----------
    50-<60 | 2,389,664    306,894 | 2,696,558 
           |     88.62      11.38 |    100.00 
-----------+----------------------+----------
    60-<70 | 1,777,500    385,785 | 2,163,285 
           |     82.17      17.83 |    100.00 
-----------+----------------------+----------
    70-<80 | 1,364,262    401,477 | 1,765,739 
           |     77.26      22.74 |    100.00 
-----------+----------------------+----------
       80+ |   782,654    275,399 | 1,058,053 
           |     73.97      26.03 |    100.00 
-----------+----------------------+----------
     Total |14,699,728  1,641,106 |16,340,834 
           |     89.96      10.04 |    100.00 
31

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

   Grouped | Chronic liver disease
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<30 | 3,110,113      2,978 | 3,113,091 
           |     99.90       0.10 |    100.00 
-----------+----------------------+----------
    30-<40 | 2,939,038      8,903 | 2,947,941 
           |     99.70       0.30 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,580,594     15,573 | 2,596,167 
           |     99.40       0.60 |    100.00 
-----------+----------------------+----------
    50-<60 | 2,672,959     23,599 | 2,696,558 
           |     99.12       0.88 |    100.00 
-----------+----------------------+----------
    60-<70 | 2,139,301     23,984 | 2,163,285 
           |     98.89       1.11 |    100.00 
-----------+----------------------+----------
    70-<80 | 1,748,426     17,313 | 1,765,739 
           |     99.02       0.98 |    100.00 
-----------+----------------------+----------
       80+ | 1,051,444      6,609 | 1,058,053 
           |     99.38       0.62 |    100.00 
-----------+----------------------+----------
     Total |16,241,875     98,959 |16,340,834 
           |     99.39       0.61 |    100.00 
21

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

   Grouped | Neurological disease
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<30 | 3,101,631     11,460 | 3,113,091 
           |     99.63       0.37 |    100.00 
-----------+----------------------+----------
    30-<40 | 2,934,044     13,897 | 2,947,941 
           |     99.53       0.47 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,578,867     17,300 | 2,596,167 
           |     99.33       0.67 |    100.00 
-----------+----------------------+----------
    50-<60 | 2,670,150     26,408 | 2,696,558 
           |     99.02       0.98 |    100.00 
-----------+----------------------+----------
    60-<70 | 2,133,067     30,218 | 2,163,285 
           |     98.60       1.40 |    100.00 
-----------+----------------------+----------
    70-<80 | 1,728,759     36,980 | 1,765,739 
           |     97.91       2.09 |    100.00 
-----------+----------------------+----------
       80+ | 1,030,594     27,459 | 1,058,053 
           |     97.40       2.60 |    100.00 
-----------+----------------------+----------
     Total |16,177,112    163,722 |16,340,834 
           |     99.00       1.00 |    100.00 
25

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

   Grouped |  Stroke or dementia
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<30 | 3,109,856      3,235 | 3,113,091 
           |     99.90       0.10 |    100.00 
-----------+----------------------+----------
    30-<40 | 2,942,157      5,784 | 2,947,941 
           |     99.80       0.20 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,582,565     13,602 | 2,596,167 
           |     99.48       0.52 |    100.00 
-----------+----------------------+----------
    50-<60 | 2,659,610     36,948 | 2,696,558 
           |     98.63       1.37 |    100.00 
-----------+----------------------+----------
    60-<70 | 2,097,503     65,782 | 2,163,285 
           |     96.96       3.04 |    100.00 
-----------+----------------------+----------
    70-<80 | 1,652,916    112,823 | 1,765,739 
           |     93.61       6.39 |    100.00 
-----------+----------------------+----------
       80+ |   908,212    149,841 | 1,058,053 
           |     85.84      14.16 |    100.00 
-----------+----------------------+----------
     Total |15,952,819    388,015 |16,340,834 
           |     97.63       2.37 |    100.00 
26

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

   Grouped |  Autoimmune disease
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<30 | 3,045,327     67,764 | 3,113,091 
           |     97.82       2.18 |    100.00 
-----------+----------------------+----------
    30-<40 | 2,842,490    105,451 | 2,947,941 
           |     96.42       3.58 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,476,003    120,164 | 2,596,167 
           |     95.37       4.63 |    100.00 
-----------+----------------------+----------
    50-<60 | 2,539,681    156,877 | 2,696,558 
           |     94.18       5.82 |    100.00 
-----------+----------------------+----------
    60-<70 | 2,012,933    150,352 | 2,163,285 
           |     93.05       6.95 |    100.00 
-----------+----------------------+----------
    70-<80 | 1,627,861    137,878 | 1,765,739 
           |     92.19       7.81 |    100.00 
-----------+----------------------+----------
       80+ |   980,314     77,739 | 1,058,053 
           |     92.65       7.35 |    100.00 
-----------+----------------------+----------
     Total |15,524,609    816,225 |16,340,834 
           |     95.00       5.00 |    100.00 
22

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |   Immunosuppressed
           |     (combination
   Grouped |      algorithm)
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<30 | 3,106,952      6,139 | 3,113,091 
           |     99.80       0.20 |    100.00 
-----------+----------------------+----------
    30-<40 | 2,939,721      8,220 | 2,947,941 
           |     99.72       0.28 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,584,720     11,447 | 2,596,167 
           |     99.56       0.44 |    100.00 
-----------+----------------------+----------
    50-<60 | 2,685,244     11,314 | 2,696,558 
           |     99.58       0.42 |    100.00 
-----------+----------------------+----------
    60-<70 | 2,157,245      6,040 | 2,163,285 
           |     99.72       0.28 |    100.00 
-----------+----------------------+----------
    70-<80 | 1,762,280      3,459 | 1,765,739 
           |     99.80       0.20 |    100.00 
-----------+----------------------+----------
       80+ | 1,056,501      1,552 | 1,058,053 
           |     99.85       0.15 |    100.00 
-----------+----------------------+----------
     Total |16,292,663     48,171 |16,340,834 
           |     99.71       0.29 |    100.00 
21

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |      Solid organ
   Grouped |      transplant
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<30 | 3,111,911      1,180 | 3,113,091 
           |     99.96       0.04 |    100.00 
-----------+----------------------+----------
    30-<40 | 2,945,882      2,059 | 2,947,941 
           |     99.93       0.07 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,593,207      2,960 | 2,596,167 
           |     99.89       0.11 |    100.00 
-----------+----------------------+----------
    50-<60 | 2,691,861      4,697 | 2,696,558 
           |     99.83       0.17 |    100.00 
-----------+----------------------+----------
    60-<70 | 2,158,784      4,501 | 2,163,285 
           |     99.79       0.21 |    100.00 
-----------+----------------------+----------
    70-<80 | 1,763,140      2,599 | 1,765,739 
           |     99.85       0.15 |    100.00 
-----------+----------------------+----------
       80+ | 1,057,417        636 | 1,058,053 
           |     99.94       0.06 |    100.00 
-----------+----------------------+----------
     Total |16,322,202     18,632 |16,340,834 
           |     99.89       0.11 |    100.00 
18

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

   Grouped |       Asplenia
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<30 | 3,111,980      1,111 | 3,113,091 
           |     99.96       0.04 |    100.00 
-----------+----------------------+----------
    30-<40 | 2,945,812      2,129 | 2,947,941 
           |     99.93       0.07 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,593,142      3,025 | 2,596,167 
           |     99.88       0.12 |    100.00 
-----------+----------------------+----------
    50-<60 | 2,691,457      5,101 | 2,696,558 
           |     99.81       0.19 |    100.00 
-----------+----------------------+----------
    60-<70 | 2,158,377      4,908 | 2,163,285 
           |     99.77       0.23 |    100.00 
-----------+----------------------+----------
    70-<80 | 1,761,215      4,524 | 1,765,739 
           |     99.74       0.26 |    100.00 
-----------+----------------------+----------
       80+ | 1,055,696      2,357 | 1,058,053 
           |     99.78       0.22 |    100.00 
-----------+----------------------+----------
     Total |16,317,679     23,155 |16,340,834 
           |     99.86       0.14 |    100.00 
27

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

   Grouped |          Non-haematological cancer
       age |     Never  Last year  2-5 years   5+ years |     Total
-----------+--------------------------------------------+----------
    18-<30 | 3,106,661        812      2,121      3,497 | 3,113,091 
           |     99.79       0.03       0.07       0.11 |    100.00 
-----------+--------------------------------------------+----------
    30-<40 | 2,929,171      2,253      6,612      9,905 | 2,947,941 
           |     99.36       0.08       0.22       0.34 |    100.00 
-----------+--------------------------------------------+----------
    40-<50 | 2,555,133      4,803     13,460     22,771 | 2,596,167 
           |     98.42       0.19       0.52       0.88 |    100.00 
-----------+--------------------------------------------+----------
    50-<60 | 2,592,745     11,459     33,679     58,675 | 2,696,558 
           |     96.15       0.42       1.25       2.18 |    100.00 
-----------+--------------------------------------------+----------
    60-<70 | 1,990,734     18,604     51,939    102,008 | 2,163,285 
           |     92.02       0.86       2.40       4.72 |    100.00 
-----------+--------------------------------------------+----------
    70-<80 | 1,516,092     21,670     65,409    162,568 | 1,765,739 
           |     85.86       1.23       3.70       9.21 |    100.00 
-----------+--------------------------------------------+----------
       80+ |   868,748     13,239     38,934    137,132 | 1,058,053 
           |     82.11       1.25       3.68      12.96 |    100.00 
-----------+--------------------------------------------+----------
     Total |15,559,284     72,840    212,154    496,556 |16,340,834 
           |     95.22       0.45       1.30       3.04 |    100.00 
25

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

   Grouped |            Haematological cancer
       age |     Never  Last year  2-5 years   5+ years |     Total
-----------+--------------------------------------------+----------
    18-<30 | 3,109,042        276        945      2,828 | 3,113,091 
           |     99.87       0.01       0.03       0.09 |    100.00 
-----------+--------------------------------------------+----------
    30-<40 | 2,942,703        355      1,080      3,803 | 2,947,941 
           |     99.82       0.01       0.04       0.13 |    100.00 
-----------+--------------------------------------------+----------
    40-<50 | 2,589,186        465      1,460      5,056 | 2,596,167 
           |     99.73       0.02       0.06       0.19 |    100.00 
-----------+--------------------------------------------+----------
    50-<60 | 2,683,978      1,098      3,263      8,219 | 2,696,558 
           |     99.53       0.04       0.12       0.30 |    100.00 
-----------+--------------------------------------------+----------
    60-<70 | 2,144,885      1,799      5,525     11,076 | 2,163,285 
           |     99.15       0.08       0.26       0.51 |    100.00 
-----------+--------------------------------------------+----------
    70-<80 | 1,739,697      2,574      7,894     15,574 | 1,765,739 
           |     98.53       0.15       0.45       0.88 |    100.00 
-----------+--------------------------------------------+----------
       80+ | 1,039,224      1,705      5,405     11,719 | 1,058,053 
           |     98.22       0.16       0.51       1.11 |    100.00 
-----------+--------------------------------------------+----------
     Total |16,248,715      8,272     25,572     58,275 |16,340,834 
           |     99.44       0.05       0.16       0.36 |    100.00 
37

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

   Grouped |     Reduced kidney function
       age |      None  Stage 3a/  Stage 4/5 |     Total
-----------+---------------------------------+----------
    18-<30 | 3,111,313      1,238        540 | 3,113,091 
           |     99.94       0.04       0.02 |    100.00 
-----------+---------------------------------+----------
    30-<40 | 2,942,643      4,097      1,201 | 2,947,941 
           |     99.82       0.14       0.04 |    100.00 
-----------+---------------------------------+----------
    40-<50 | 2,581,423     12,604      2,140 | 2,596,167 
           |     99.43       0.49       0.08 |    100.00 
-----------+---------------------------------+----------
    50-<60 | 2,644,086     47,894      4,578 | 2,696,558 
           |     98.05       1.78       0.17 |    100.00 
-----------+---------------------------------+----------
    60-<70 | 2,030,999    124,775      7,511 | 2,163,285 
           |     93.88       5.77       0.35 |    100.00 
-----------+---------------------------------+----------
    70-<80 | 1,441,008    308,216     16,515 | 1,765,739 
           |     81.61      17.46       0.94 |    100.00 
-----------+---------------------------------+----------
       80+ |   587,409    429,777     40,867 | 1,058,053 
           |     55.52      40.62       3.86 |    100.00 
-----------+---------------------------------+----------
     Total |15,338,881    928,601     73,352 |16,340,834 
           |     93.87       5.68       0.45 |    100.00 
22

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |       Diagnosed
   Grouped |     hypertension
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<30 | 3,093,412     19,679 | 3,113,091 
           |     99.37       0.63 |    100.00 
-----------+----------------------+----------
    30-<40 | 2,872,756     75,185 | 2,947,941 
           |     97.45       2.55 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,356,756    239,411 | 2,596,167 
           |     90.78       9.22 |    100.00 
-----------+----------------------+----------
    50-<60 | 2,118,226    578,332 | 2,696,558 
           |     78.55      21.45 |    100.00 
-----------+----------------------+----------
    60-<70 | 1,357,955    805,330 | 2,163,285 
           |     62.77      37.23 |    100.00 
-----------+----------------------+----------
    70-<80 |   812,772    952,967 | 1,765,739 
           |     46.03      53.97 |    100.00 
-----------+----------------------+----------
       80+ |   331,379    726,674 | 1,058,053 
           |     31.32      68.68 |    100.00 
-----------+----------------------+----------
     Total |12,943,256  3,397,578 |16,340,834 
           |     79.21      20.79 |    100.00 

. 
. 
.  * Relationships with sex
. foreach var of varlist asthma                                           ///
>                                         chronic_respiratory_disease     ///
>                                         chronic_cardiac_disease         ///
>                                         diabetes                                                ///
>                                         chronic_liver_disease           ///
>                                         other_neuro                     ///
>                                         stroke_dementia ///
>                                         ra_sle_psoriasis                                ///
>                                         other_immuno                            ///
>                                         organ_trans                     /// 
>                                         asplenia                        /// 
>                                         cancer_exhaem_cat                                               ///
>                                         cancer_haem_cat                                                 ///
>                                         reduced_kidney_function_cat ///
>                                         hypertension                     ///    
>                                                                                 {
  2.                                                 
.         safetab male `var', row 
  3. }
12

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |    Asthma category
      Male |         0          1 |     Total
-----------+----------------------+----------
         0 | 6,911,160  1,384,617 | 8,295,777 
           |     83.31      16.69 |    100.00 
-----------+----------------------+----------
         1 | 6,841,213  1,203,844 | 8,045,057 
           |     85.04      14.96 |    100.00 
-----------+----------------------+----------
     Total |13,752,373  2,588,461 |16,340,834 
           |     84.16      15.84 |    100.00 
33

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |  Chronic Respiratory
           |       Diseases
      Male |         0          1 |     Total
-----------+----------------------+----------
         0 | 7,964,531    331,246 | 8,295,777 
           |     96.01       3.99 |    100.00 
-----------+----------------------+----------
         1 | 7,707,847    337,210 | 8,045,057 
           |     95.81       4.19 |    100.00 
-----------+----------------------+----------
     Total |15,672,378    668,456 |16,340,834 
           |     95.91       4.09 |    100.00 
29

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |    Chronic Cardiac
           |       Diseases
      Male |         0          1 |     Total
-----------+----------------------+----------
         0 | 7,853,009    442,768 | 8,295,777 
           |     94.66       5.34 |    100.00 
-----------+----------------------+----------
         1 | 7,380,704    664,353 | 8,045,057 
           |     91.74       8.26 |    100.00 
-----------+----------------------+----------
     Total |15,233,713  1,107,121 |16,340,834 
           |     93.22       6.78 |    100.00 
14

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |       Diabetes
      Male |         0          1 |     Total
-----------+----------------------+----------
         0 | 7,532,284    763,493 | 8,295,777 
           |     90.80       9.20 |    100.00 
-----------+----------------------+----------
         1 | 7,167,444    877,613 | 8,045,057 
           |     89.09      10.91 |    100.00 
-----------+----------------------+----------
     Total |14,699,728  1,641,106 |16,340,834 
           |     89.96      10.04 |    100.00 
27

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           | Chronic liver disease
      Male |         0          1 |     Total
-----------+----------------------+----------
         0 | 8,253,318     42,459 | 8,295,777 
           |     99.49       0.51 |    100.00 
-----------+----------------------+----------
         1 | 7,988,557     56,500 | 8,045,057 
           |     99.30       0.70 |    100.00 
-----------+----------------------+----------
     Total |16,241,875     98,959 |16,340,834 
           |     99.39       0.61 |    100.00 
17

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           | Neurological disease
      Male |         0          1 |     Total
-----------+----------------------+----------
         0 | 8,210,620     85,157 | 8,295,777 
           |     98.97       1.03 |    100.00 
-----------+----------------------+----------
         1 | 7,966,492     78,565 | 8,045,057 
           |     99.02       0.98 |    100.00 
-----------+----------------------+----------
     Total |16,177,112    163,722 |16,340,834 
           |     99.00       1.00 |    100.00 
21

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |  Stroke or dementia
      Male |         0          1 |     Total
-----------+----------------------+----------
         0 | 8,109,275    186,502 | 8,295,777 
           |     97.75       2.25 |    100.00 
-----------+----------------------+----------
         1 | 7,843,544    201,513 | 8,045,057 
           |     97.50       2.50 |    100.00 
-----------+----------------------+----------
     Total |15,952,819    388,015 |16,340,834 
           |     97.63       2.37 |    100.00 
22

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |  Autoimmune disease
      Male |         0          1 |     Total
-----------+----------------------+----------
         0 | 7,837,811    457,966 | 8,295,777 
           |     94.48       5.52 |    100.00 
-----------+----------------------+----------
         1 | 7,686,798    358,259 | 8,045,057 
           |     95.55       4.45 |    100.00 
-----------+----------------------+----------
     Total |15,524,609    816,225 |16,340,834 
           |     95.00       5.00 |    100.00 
18

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |   Immunosuppressed
           |     (combination
           |      algorithm)
      Male |         0          1 |     Total
-----------+----------------------+----------
         0 | 8,274,193     21,584 | 8,295,777 
           |     99.74       0.26 |    100.00 
-----------+----------------------+----------
         1 | 8,018,470     26,587 | 8,045,057 
           |     99.67       0.33 |    100.00 
-----------+----------------------+----------
     Total |16,292,663     48,171 |16,340,834 
           |     99.71       0.29 |    100.00 
17

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |      Solid organ
           |      transplant
      Male |         0          1 |     Total
-----------+----------------------+----------
         0 | 8,288,236      7,541 | 8,295,777 
           |     99.91       0.09 |    100.00 
-----------+----------------------+----------
         1 | 8,033,966     11,091 | 8,045,057 
           |     99.86       0.14 |    100.00 
-----------+----------------------+----------
     Total |16,322,202     18,632 |16,340,834 
           |     99.89       0.11 |    100.00 
14

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |       Asplenia
      Male |         0          1 |     Total
-----------+----------------------+----------
         0 | 8,285,662     10,115 | 8,295,777 
           |     99.88       0.12 |    100.00 
-----------+----------------------+----------
         1 | 8,032,017     13,040 | 8,045,057 
           |     99.84       0.16 |    100.00 
-----------+----------------------+----------
     Total |16,317,679     23,155 |16,340,834 
           |     99.86       0.14 |    100.00 
23

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |          Non-haematological cancer
      Male |     Never  Last year  2-5 years   5+ years |     Total
-----------+--------------------------------------------+----------
         0 | 7,851,127     35,368    107,935    301,347 | 8,295,777 
           |     94.64       0.43       1.30       3.63 |    100.00 
-----------+--------------------------------------------+----------
         1 | 7,708,157     37,472    104,219    195,209 | 8,045,057 
           |     95.81       0.47       1.30       2.43 |    100.00 
-----------+--------------------------------------------+----------
     Total |15,559,284     72,840    212,154    496,556 |16,340,834 
           |     95.22       0.45       1.30       3.04 |    100.00 
21

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |            Haematological cancer
      Male |     Never  Last year  2-5 years   5+ years |     Total
-----------+--------------------------------------------+----------
         0 | 8,254,455      3,571     11,094     26,657 | 8,295,777 
           |     99.50       0.04       0.13       0.32 |    100.00 
-----------+--------------------------------------------+----------
         1 | 7,994,260      4,701     14,478     31,618 | 8,045,057 
           |     99.37       0.06       0.18       0.39 |    100.00 
-----------+--------------------------------------------+----------
     Total |16,248,715      8,272     25,572     58,275 |16,340,834 
           |     99.44       0.05       0.16       0.36 |    100.00 
33

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |     Reduced kidney function
      Male |      None  Stage 3a/  Stage 4/5 |     Total
-----------+---------------------------------+----------
         0 | 7,729,064    530,072     36,641 | 8,295,777 
           |     93.17       6.39       0.44 |    100.00 
-----------+---------------------------------+----------
         1 | 7,609,817    398,529     36,711 | 8,045,057 
           |     94.59       4.95       0.46 |    100.00 
-----------+---------------------------------+----------
     Total |15,338,881    928,601     73,352 |16,340,834 
           |     93.87       5.68       0.45 |    100.00 
18

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |       Diagnosed
           |     hypertension
      Male |         0          1 |     Total
-----------+----------------------+----------
         0 | 6,579,236  1,716,541 | 8,295,777 
           |     79.31      20.69 |    100.00 
-----------+----------------------+----------
         1 | 6,364,020  1,681,037 | 8,045,057 
           |     79.10      20.90 |    100.00 
-----------+----------------------+----------
     Total |12,943,256  3,397,578 |16,340,834 
           |     79.21      20.79 |    100.00 

. 
.  * Relationships with smoking
. foreach var of varlist  asthma                                          ///
>                                         chronic_respiratory_disease     ///
>                                         chronic_cardiac_disease         ///
>                                         diabetes                                                ///
>                                         chronic_liver_disease           ///
>                                         other_neuro                     ///
>                                         stroke_dementia ///
>                                         ra_sle_psoriasis                                ///
>                                         other_immuno                            ///
>                                         organ_trans                     /// 
>                                         asplenia                        /// 
>                                         cancer_exhaem_cat                                               ///
>                                         cancer_haem_cat                                                 ///
>                                         reduced_kidney_function_cat ///
>                                         hypertension                            ///
>                                         {
  2.         
.         safetab smoke `var', row 
  3. }
13

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

     Smoking |    Asthma category
      status |         0          1 |     Total
-------------+----------------------+----------
       Never | 6,321,638  1,153,323 | 7,474,961 
             |     84.57      15.43 |    100.00 
-------------+----------------------+----------
      Former | 4,358,356    918,255 | 5,276,611 
             |     82.60      17.40 |    100.00 
-------------+----------------------+----------
     Current | 2,371,096    482,891 | 2,853,987 
             |     83.08      16.92 |    100.00 
-------------+----------------------+----------
       Total |13,051,090  2,554,469 |15,605,559 
             |     83.63      16.37 |    100.00 
34

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

             |  Chronic Respiratory
     Smoking |       Diseases
      status |         0          1 |     Total
-------------+----------------------+----------
       Never | 7,367,847    107,114 | 7,474,961 
             |     98.57       1.43 |    100.00 
-------------+----------------------+----------
      Former | 4,896,656    379,955 | 5,276,611 
             |     92.80       7.20 |    100.00 
-------------+----------------------+----------
     Current | 2,673,996    179,991 | 2,853,987 
             |     93.69       6.31 |    100.00 
-------------+----------------------+----------
       Total |14,938,499    667,060 |15,605,559 
             |     95.73       4.27 |    100.00 
30

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

             |    Chronic Cardiac
     Smoking |       Diseases
      status |         0          1 |     Total
-------------+----------------------+----------
       Never | 7,114,961    360,000 | 7,474,961 
             |     95.18       4.82 |    100.00 
-------------+----------------------+----------
      Former | 4,673,434    603,177 | 5,276,611 
             |     88.57      11.43 |    100.00 
-------------+----------------------+----------
     Current | 2,714,534    139,453 | 2,853,987 
             |     95.11       4.89 |    100.00 
-------------+----------------------+----------
       Total |14,502,929  1,102,630 |15,605,559 
             |     92.93       7.07 |    100.00 
15

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

     Smoking |       Diabetes
      status |         0          1 |     Total
-------------+----------------------+----------
       Never | 6,836,205    638,756 | 7,474,961 
             |     91.45       8.55 |    100.00 
-------------+----------------------+----------
      Former | 4,505,370    771,241 | 5,276,611 
             |     85.38      14.62 |    100.00 
-------------+----------------------+----------
     Current | 2,628,132    225,855 | 2,853,987 
             |     92.09       7.91 |    100.00 
-------------+----------------------+----------
       Total |13,969,707  1,635,852 |15,605,559 
             |     89.52      10.48 |    100.00 
28

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

     Smoking | Chronic liver disease
      status |         0          1 |     Total
-------------+----------------------+----------
       Never | 7,446,236     28,725 | 7,474,961 
             |     99.62       0.38 |    100.00 
-------------+----------------------+----------
      Former | 5,236,381     40,230 | 5,276,611 
             |     99.24       0.76 |    100.00 
-------------+----------------------+----------
     Current | 2,824,681     29,306 | 2,853,987 
             |     98.97       1.03 |    100.00 
-------------+----------------------+----------
       Total |15,507,298     98,261 |15,605,559 
             |     99.37       0.63 |    100.00 
18

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

     Smoking | Neurological disease
      status |         0          1 |     Total
-------------+----------------------+----------
       Never | 7,402,432     72,529 | 7,474,961 
             |     99.03       0.97 |    100.00 
-------------+----------------------+----------
      Former | 5,207,529     69,082 | 5,276,611 
             |     98.69       1.31 |    100.00 
-------------+----------------------+----------
     Current | 2,833,661     20,326 | 2,853,987 
             |     99.29       0.71 |    100.00 
-------------+----------------------+----------
       Total |15,443,622    161,937 |15,605,559 
             |     98.96       1.04 |    100.00 
22

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

     Smoking |  Stroke or dementia
      status |         0          1 |     Total
-------------+----------------------+----------
       Never | 7,343,893    131,068 | 7,474,961 
             |     98.25       1.75 |    100.00 
-------------+----------------------+----------
      Former | 5,071,698    204,913 | 5,276,611 
             |     96.12       3.88 |    100.00 
-------------+----------------------+----------
     Current | 2,803,283     50,704 | 2,853,987 
             |     98.22       1.78 |    100.00 
-------------+----------------------+----------
       Total |15,218,874    386,685 |15,605,559 
             |     97.52       2.48 |    100.00 
23

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

     Smoking |  Autoimmune disease
      status |         0          1 |     Total
-------------+----------------------+----------
       Never | 7,182,315    292,646 | 7,474,961 
             |     96.08       3.92 |    100.00 
-------------+----------------------+----------
      Former | 4,919,212    357,399 | 5,276,611 
             |     93.23       6.77 |    100.00 
-------------+----------------------+----------
     Current | 2,695,922    158,065 | 2,853,987 
             |     94.46       5.54 |    100.00 
-------------+----------------------+----------
       Total |14,797,449    808,110 |15,605,559 
             |     94.82       5.18 |    100.00 
19

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

             |   Immunosuppressed
             |     (combination
     Smoking |      algorithm)
      status |         0          1 |     Total
-------------+----------------------+----------
       Never | 7,451,577     23,384 | 7,474,961 
             |     99.69       0.31 |    100.00 
-------------+----------------------+----------
      Former | 5,261,722     14,889 | 5,276,611 
             |     99.72       0.28 |    100.00 
-------------+----------------------+----------
     Current | 2,845,087      8,900 | 2,853,987 
             |     99.69       0.31 |    100.00 
-------------+----------------------+----------
       Total |15,558,386     47,173 |15,605,559 
             |     99.70       0.30 |    100.00 
18

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

             |      Solid organ
     Smoking |      transplant
      status |         0          1 |     Total
-------------+----------------------+----------
       Never | 7,466,323      8,638 | 7,474,961 
             |     99.88       0.12 |    100.00 
-------------+----------------------+----------
      Former | 5,268,724      7,887 | 5,276,611 
             |     99.85       0.15 |    100.00 
-------------+----------------------+----------
     Current | 2,852,006      1,981 | 2,853,987 
             |     99.93       0.07 |    100.00 
-------------+----------------------+----------
       Total |15,587,053     18,506 |15,605,559 
             |     99.88       0.12 |    100.00 
15

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

     Smoking |       Asplenia
      status |         0          1 |     Total
-------------+----------------------+----------
       Never | 7,466,458      8,503 | 7,474,961 
             |     99.89       0.11 |    100.00 
-------------+----------------------+----------
      Former | 5,266,525     10,086 | 5,276,611 
             |     99.81       0.19 |    100.00 
-------------+----------------------+----------
     Current | 2,849,613      4,374 | 2,853,987 
             |     99.85       0.15 |    100.00 
-------------+----------------------+----------
       Total |15,582,596     22,963 |15,605,559 
             |     99.85       0.15 |    100.00 
24

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

     Smoking |          Non-haematological cancer
      status |     Never  Last year  2-5 years   5+ years |     Total
-------------+--------------------------------------------+----------
       Never | 7,164,384     26,439     81,502    202,636 | 7,474,961 
             |     95.85       0.35       1.09       2.71 |    100.00 
-------------+--------------------------------------------+----------
      Former | 4,884,649     36,048    107,311    248,603 | 5,276,611 
             |     92.57       0.68       2.03       4.71 |    100.00 
-------------+--------------------------------------------+----------
     Current | 2,777,831      9,906     22,408     43,842 | 2,853,987 
             |     97.33       0.35       0.79       1.54 |    100.00 
-------------+--------------------------------------------+----------
       Total |14,826,864     72,393    211,221    495,081 |15,605,559 
             |     95.01       0.46       1.35       3.17 |    100.00 
22

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

     Smoking |            Haematological cancer
      status |     Never  Last year  2-5 years   5+ years |     Total
-------------+--------------------------------------------+----------
       Never | 7,436,070      3,313     10,247     25,331 | 7,474,961 
             |     99.48       0.04       0.14       0.34 |    100.00 
-------------+--------------------------------------------+----------
      Former | 5,233,544      3,920     12,559     26,588 | 5,276,611 
             |     99.18       0.07       0.24       0.50 |    100.00 
-------------+--------------------------------------------+----------
     Current | 2,844,513        962      2,594      5,918 | 2,853,987 
             |     99.67       0.03       0.09       0.21 |    100.00 
-------------+--------------------------------------------+----------
       Total |15,514,127      8,195     25,400     57,837 |15,605,559 
             |     99.41       0.05       0.16       0.37 |    100.00 
34

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

     Smoking |     Reduced kidney function
      status |      None  Stage 3a/  Stage 4/5 |     Total
-------------+---------------------------------+----------
       Never | 7,080,032    368,854     26,075 | 7,474,961 
             |     94.72       4.93       0.35 |    100.00 
-------------+---------------------------------+----------
      Former | 4,742,698    492,558     41,355 | 5,276,611 
             |     89.88       9.33       0.78 |    100.00 
-------------+---------------------------------+----------
     Current | 2,783,235     65,054      5,698 | 2,853,987 
             |     97.52       2.28       0.20 |    100.00 
-------------+---------------------------------+----------
       Total |14,605,965    926,466     73,128 |15,605,559 
             |     93.59       5.94       0.47 |    100.00 
19

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

             |       Diagnosed
     Smoking |     hypertension
      status |         0          1 |     Total
-------------+----------------------+----------
       Never | 6,099,224  1,375,737 | 7,474,961 
             |     81.60      18.40 |    100.00 
-------------+----------------------+----------
      Former | 3,643,568  1,633,043 | 5,276,611 
             |     69.05      30.95 |    100.00 
-------------+----------------------+----------
     Current | 2,473,854    380,133 | 2,853,987 
             |     86.68      13.32 |    100.00 
-------------+----------------------+----------
       Total |12,216,646  3,388,913 |15,605,559 
             |     78.28      21.72 |    100.00 

. 
. 
. /* SENSE CHECK OUTCOMES=======================================================*/
. 
. safetab covid_death_itu covid_tpp_prob_or_susp  , row col
41

+-------------------+
| Key               |
|-------------------|
|     frequency     |
|  row percentage   |
| column percentage |
+-------------------+

Failure/ce |
   nsoring |
 indicator |
       for |   Failure/censoring
  outcome: |     indicator for
     covid |    outcome: covid
 death/ITU |    prob/susp. case
      adm. |         0          1 |     Total
-----------+----------------------+----------
         0 |15,630,799    645,783 |16,276,582 
           |     96.03       3.97 |    100.00 
           |     99.63      98.98 |     99.61 
-----------+----------------------+----------
         1 |    57,566      6,686 |    64,252 
           |     89.59      10.41 |    100.00 
           |      0.37       1.02 |      0.39 
-----------+----------------------+----------
     Total |15,688,365    652,469 |16,340,834 
           |     96.01       3.99 |    100.00 
           |    100.00     100.00 |    100.00 

. safetab covid_death_itu covid_tpp_prob  , row col
33

+-------------------+
| Key               |
|-------------------|
|     frequency     |
|  row percentage   |
| column percentage |
+-------------------+

Failure/ce |
   nsoring |
 indicator |
       for |   Failure/censoring
  outcome: |     indicator for
     covid |  outcome: covid prob
 death/ITU |         case
      adm. |         0          1 |     Total
-----------+----------------------+----------
         0 |16,232,461     44,121 |16,276,582 
           |     99.73       0.27 |    100.00 
           |     99.62      96.64 |     99.61 
-----------+----------------------+----------
         1 |    62,716      1,536 |    64,252 
           |     97.61       2.39 |    100.00 
           |      0.38       3.36 |      0.39 
-----------+----------------------+----------
     Total |16,295,177     45,657 |16,340,834 
           |     99.72       0.28 |    100.00 
           |    100.00     100.00 |    100.00 

. 
. 
. * Close log file 
. log close
      name:  <unnamed>
       log:  E:\caroline\school-age-children-and-covid\analysis\log\02_an_data_checks.log
  log type:  text
 closed on:  14 Jul 2020, 23:47:46
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
